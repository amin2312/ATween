/*
MIT License

Copyright (c) 2012 - 2021 @jonobr1 / http://jono.fyi

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/
var Two=(()=>{var Et=Object.defineProperty;var Pi=Object.getOwnPropertyDescriptor;var Ei=Object.getOwnPropertyNames;var Li=Object.prototype.hasOwnProperty;var Ii=e=>Et(e,"__esModule",{value:!0});var Lt=(e,t)=>{for(var i in t)Et(e,i,{get:t[i],enumerable:!0})},Bi=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Ei(t))!Li.call(e,s)&&(i||s!=="default")&&Et(e,s,{get:()=>t[s],enumerable:!(r=Pi(t,s))||r.enumerable});return e};var Ni=(e=>(t,i)=>e&&e.get(t)||(i=Bi(Ii({}),t,1),e&&e.set(t,i),i))(typeof WeakMap!="undefined"?new WeakMap:0);var Or={};Lt(Or,{default:()=>Rr});var Vi={move:"M",line:"L",curve:"C",arc:"A",close:"Z"},b=Vi;var Vt={};Lt(Vt,{HALF_PI:()=>J,NumArray:()=>ye,TWO_PI:()=>K,decomposeMatrix:()=>Ge,getComputedMatrix:()=>Se,getPoT:()=>Nt,lerp:()=>ae,mod:()=>re,setMatrix:()=>It,toFixed:()=>q});var ft;typeof window!="undefined"?ft=window:typeof global!="undefined"?ft=global:typeof self!="undefined"&&(ft=self);var D=ft;var li,K=Math.PI*2,J=Math.PI*.5,Ge=function(e,t,i,r,s,a){var n;return arguments.length<=1?(n=e.a,t=e.b,i=e.c,r=e.d,s=e.e,a=e.f):n=e,{translateX:s,translateY:a,scaleX:Math.sqrt(n*n+t*t),scaleY:Math.sqrt(i*i+r*r),rotation:180*Math.atan2(t,n)/Math.PI}},It=function(e){li=e},Se=function(e,t){t=t&&t.identity()||new li;for(var i=e,r=[];i&&i._matrix;)r.push(i._matrix),i=i.parent;r.reverse();for(var s=0;s<r.length;s++){var a=r[s],n=a.elements;t.multiply(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9])}return t},ae=function(e,t,i){return i*(t-e)+e},Bt=[2,4,8,16,32,64,128,256,512,1024,2048,4096],Nt=function(e){for(var t=0;Bt[t]&&Bt[t]<e;)t++;return Bt[t]},re=function(e,t){for(;e<0;)e+=t;return e%t},ye=D.Float32Array||Array,zi=Math.floor,q=function(e){return zi(e*1e6)/1e6};var Dt={};Lt(Dt,{Curve:()=>Ke,getAnchorsFromArcData:()=>qi,getComponentOnCubicBezier:()=>$e,getControlPoints:()=>_i,getCurveBoundingBox:()=>Ut,getCurveFromPoints:()=>jt,getCurveLength:()=>Gt,getReflection:()=>ct,integrate:()=>di,subdivide:()=>et});var hi=Array.prototype.slice,Gi=function(e){if(e==null)return!1;var t=e.length;return typeof t=="number"&&t>=0&&t<4294967296},Ui={isNaN:function(e){return typeof e=="number"&&e!==+e},isElement:function(e){return!!(e&&e.nodeType===1)},isObject:function(e){var t=typeof e;return t==="function"||t==="object"&&!!e},extend:function(e){for(var t=hi.call(arguments,1),i=0;i<t.length;i++){var r=t[i];for(var s in r)e[s]=r[s]}return e},defaults:function(e){for(var t=hi.call(arguments,1),i=0;i<t.length;i++){var r=t[i];for(var s in r)e[s]===void 0&&(e[s]=r[s])}return e},each:function(e,t,i){for(var r=i||this,s=!Gi(e)&&Object.keys(e),a=(s||e).length,n=0;n<a;n++){var o=s?s[n]:n;t.call(r,e[o],o,e)}return e},performance:D.performance&&D.performance.now?D.performance:Date},f=Ui;var zt={on:fi,off:ci,trigger:function(e){var t=this;if(!t._events)return t;var i=Array.prototype.slice.call(arguments,1),r=t._events[e];return r&&ji(t,r,i),t},listen:function(e,t,i){var r=this;if(e){var s=function(){i.apply(r,arguments)};s.obj=e,s.name=t,s.handler=i,e.on(t,s)}return r},ignore:function(e,t,i){var r=this;return e.off(t,i),r},Types:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert",order:"order",load:"load"}};zt.bind=fi;zt.unbind=ci;function fi(e,t){var i=this;i._events||(i._events={});var r=i._events[e]||(i._events[e]=[]);return r.push(t),i}function ci(e,t){var i=this;if(!i._events)return i;if(!e&&!t)return i._events={},i;for(var r=e?[e]:Object.keys(i._events),s=0,a=r.length;s<a;s++){e=r[s];var n=i._events[e];if(n){var o=[];if(t)for(var l=0,h=n.length;l<h;l++){var _=n[l];_=_.handler?_.handler:_,t!==_&&o.push(_)}i._events[e]=o}}return i}function ji(e,t,i){var r;switch(i.length){case 0:r=function(a){t[a].call(e,i[0])};break;case 1:r=function(a){t[a].call(e,i[0],i[1])};break;case 2:r=function(a){t[a].call(e,i[0],i[1],i[2])};break;case 3:r=function(a){t[a].call(e,i[0],i[1],i[2],i[3])};break;default:r=function(a){t[a].apply(e,i)}}for(var s=0;s<t.length;s++)r(s)}var m=zt;function ce(e,t){this.x=e||0,this.y=t||0}f.extend(ce,{zero:new ce,add:function(e,t){return new ce(e.x+t.x,e.y+t.y)},sub:function(e,t){return new ce(e.x-t.x,e.y-t.y)},subtract:function(e,t){return ce.sub(e,t)},ratioBetween:function(e,t){return(e.x*t.x+e.y*t.y)/(e.length()*t.length())},angleBetween:function(e,t){var i,r;return arguments.length>=4?(i=arguments[0]-arguments[2],r=arguments[1]-arguments[3],Math.atan2(r,i)):(i=e.x-t.x,r=e.y-t.y,Math.atan2(r,i))},distanceBetween:function(e,t){return Math.sqrt(ce.distanceBetweenSquared(e,t))},distanceBetweenSquared:function(e,t){var i=e.x-t.x,r=e.y-t.y;return i*i+r*r},MakeObservable:function(e){e.bind=e.on=function(){return this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",Hi),Object.defineProperty(this,"y",Wi),f.extend(this,Di),this._bound=!0),m.bind.apply(this,arguments),this}}});f.extend(ce.prototype,m,{constructor:ce,set:function(e,t){return this.x=e,this.y=t,this},copy:function(e){return this.x=e.x,this.y=e.y,this},clear:function(){return this.x=0,this.y=0,this},clone:function(){return new ce(this.x,this.y)},add:function(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this.x+=e,this.y+=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this.x+=e.x,this.y+=e.y):(this.x+=e,this.y+=t),this)},addSelf:function(e){return this.add.apply(this,arguments)},sub:function(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this.x-=e,this.y-=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this.x-=e.x,this.y-=e.y):(this.x-=e,this.y-=t),this)},subtract:function(){return this.sub.apply(this,arguments)},subSelf:function(e){return this.sub.apply(this,arguments)},subtractSelf:function(e){return this.sub.apply(this,arguments)},multiply:function(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this.x*=e,this.y*=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this.x*=e.x,this.y*=e.y):(this.x*=e,this.y*=t),this)},multiplySelf:function(e){return this.multiply.apply(this,arguments)},multiplyScalar:function(e){return this.multiply(e)},divide:function(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this.x/=e,this.y/=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this.x/=e.x,this.y/=e.y):(this.x/=e,this.y/=t),f.isNaN(this.x)&&(this.x=0),f.isNaN(this.y)&&(this.y=0),this)},divideSelf:function(e){return this.divide.apply(this,arguments)},divideScalar:function(e){return this.divide(e)},negate:function(){return this.multiply(-1)},dot:function(e){return this.x*e.x+this.y*e.y},length:function(){return Math.sqrt(this.lengthSquared())},lengthSquared:function(){return this.x*this.x+this.y*this.y},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},setLength:function(e){return this.normalize().multiplyScalar(e)},equals:function(e,t){return t=typeof t=="undefined"?1e-4:t,this.distanceTo(e)<t},lerp:function(e,t){var i=(e.x-this.x)*t+this.x,r=(e.y-this.y)*t+this.y;return this.set(i,r)},isZero:function(e){return e=typeof e=="undefined"?1e-4:e,this.length()<e},toString:function(){return this.x+", "+this.y},toObject:function(){return{x:this.x,y:this.y}},rotate:function(e){var t=Math.cos(e),i=Math.sin(e);return this.x=this.x*t-this.y*i,this.y=this.x*i+this.y*t,this}});var Di={constructor:ce,set:function(e,t){return this._x=e,this._y=t,this.trigger(m.Types.change)},copy:function(e){return this._x=e.x,this._y=e.y,this.trigger(m.Types.change)},clear:function(){return this._x=0,this._y=0,this.trigger(m.Types.change)},clone:function(){return new ce(this._x,this._y)},add:function(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this._x+=e,this._y+=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this._x+=e.x,this._y+=e.y):(this._x+=e,this._y+=t),this.trigger(m.Types.change))},sub:function(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this._x-=e,this._y-=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this._x-=e.x,this._y-=e.y):(this._x-=e,this._y-=t),this.trigger(m.Types.change))},multiply:function(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this._x*=e,this._y*=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this._x*=e.x,this._y*=e.y):(this._x*=e,this._y*=t),this.trigger(m.Types.change))},divide:function(e,t){return arguments.length<=0?this:(arguments.length<=1?typeof e=="number"?(this._x/=e,this._y/=e):e&&typeof e.x=="number"&&typeof e.y=="number"&&(this._x/=e.x,this._y/=e.y):(this._x/=e,this._y/=t),f.isNaN(this._x)&&(this._x=0),f.isNaN(this._y)&&(this._y=0),this.trigger(m.Types.change))},dot:function(e){return this._x*e.x+this._y*e.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},distanceToSquared:function(e){var t=this._x-e.x,i=this._y-e.y;return t*t+i*i},lerp:function(e,t){var i=(e.x-this._x)*t+this._x,r=(e.y-this._y)*t+this._y;return this.set(i,r)},toString:function(){return this._x+", "+this._y},toObject:function(){return{x:this._x,y:this._y}},rotate:function(e){var t=Math.cos(e),i=Math.sin(e);return this._x=this._x*t-this._y*i,this._y=this._x*i+this._y*t,this}},Hi={enumerable:!0,get:function(){return this._x},set:function(e){this._x=e,this.trigger(m.Types.change,"x")}},Wi={enumerable:!0,get:function(){return this._y},set:function(e){this._y=e,this.trigger(m.Types.change,"y")}};ce.MakeObservable(ce.prototype);var w=ce;function Oe(e,t,i,r,s,a,n){w.call(this,e,t),this._broadcast=function(){this.trigger(m.Types.change)}.bind(this),this._command=n||b.move,this._relative=!0;var o=typeof i=="number",l=typeof r=="number",h=typeof s=="number",_=typeof a=="number";(o||l||h||_)&&Oe.AppendCurveProperties(this),o&&(this.controls.left.x=i),l&&(this.controls.left.y=r),h&&(this.controls.right.x=s),_&&(this.controls.right.y=a)}f.extend(Oe,{AppendCurveProperties:function(e){e.relative=!0,e.controls={},e.controls.left=new w(0,0),e.controls.right=new w(0,0)},MakeObservable:function(e){Object.defineProperty(e,"command",{enumerable:!0,get:function(){return this._command},set:function(t){this._command=t,this._command===b.curve&&!f.isObject(this.controls)&&Oe.AppendCurveProperties(this),this.trigger(m.Types.change)}}),Object.defineProperty(e,"relative",{enumerable:!0,get:function(){return this._relative},set:function(t){this._relative!=t&&(this._relative=!!t,this.trigger(m.Types.change))}}),f.extend(e,w.prototype,ui),e.bind=e.on=function(){var t=this._bound;w.prototype.bind.apply(this,arguments),t||f.extend(this,ui)}}});var ui={constructor:Oe,listen:function(){return f.isObject(this.controls)||Oe.AppendCurveProperties(this),this.controls.left.bind(m.Types.change,this._broadcast),this.controls.right.bind(m.Types.change,this._broadcast),this},ignore:function(){return this.controls.left.unbind(m.Types.change,this._broadcast),this.controls.right.unbind(m.Types.change,this._broadcast),this},copy:function(e){return this.x=e.x,this.y=e.y,typeof e.command=="string"&&(this.command=e.command),f.isObject(e.controls)&&(f.isObject(this.controls)||Oe.AppendCurveProperties(this),this.controls.left.copy(e.controls.left),this.controls.right.copy(e.controls.right)),typeof e.relative=="boolean"&&(this.relative=e.relative),this.command===b.arc&&(this.rx=e.rx,this.ry=e.ry,this.xAxisRotation=e.xAxisRotation,this.largeArcFlag=e.largeArcFlag,this.sweepFlag=e.sweepFlag),this},clone:function(){var e=this.controls,t=new Oe(this.x,this.y,e&&e.left.x,e&&e.left.y,e&&e.right.x,e&&e.right.y,this.command);return t.relative=this._relative,t},toObject:function(){var e={x:this.x,y:this.y};return this._command&&(e.command=this._command),this._relative&&(e.relative=this._relative),this.controls&&(e.controls={left:this.controls.left.toObject(),right:this.controls.right.toObject()}),e},toString:function(){return this.controls?[this._x,this._y,this.controls.left.x,this.controls.left.y,this.controls.right.x,this.controls.right.y,this._command,this._relative?1:0].join(", "):[this._x,this._y].join(", ")}};Oe.MakeObservable(Oe.prototype);var M=Oe;var Xi=0,Yi={nextFrameID:null,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.7.14",PublishDate:"2021-12-20T18:06:45.412Z",Identifier:"two-",Resolution:12,AutoCalculateImportedMatrices:!0,Instances:[],uniqueId:function(){return Xi++}},ee=Yi;var Ke={CollinearityEpsilon:Math.pow(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:Number.EPSILON},abscissas:[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],weights:[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]]},$e=function(e,t,i,r,s){var a=1-e;return a*a*a*t+3*a*a*e*i+3*a*e*e*r+e*e*e*s},et=function(e,t,i,r,s,a,n,o,l){l=l||Ke.RecursionLimit;var h=l+1;if(Math.abs(e-n)<.001&&Math.abs(t-o)<.001)return[new M(n,o)];for(var _=[],d=0;d<h;d++){var c=d/h,u=$e(c,e,i,s,n),g=$e(c,t,r,a,o);_.push(new M(u,g))}return _},Gt=function(e,t,i,r,s,a,n,o,l){if(e===i&&t===r&&s===n&&a===o){var h=n-e,_=o-t;return Math.sqrt(h*h+_*_)}var d=9*(i-s)+3*(n-e),c=6*(e+s)-12*i,u=3*(i-e),g=9*(r-a)+3*(o-t),y=6*(t+a)-12*r,x=3*(r-t),p=function(v){var k=(d*v+c)*v+u,T=(g*v+y)*v+x;return Math.sqrt(k*k+T*T)};return di(p,0,1,l||Ke.RecursionLimit)},Ut=function(e,t,i,r,s,a,n,o){for(var l=[],h=[[],[]],_,d,c,u,g,y,x,p,v=0;v<2;++v){if(v==0?(d=6*e-12*i+6*s,_=-3*e+9*i-9*s+3*n,c=3*i-3*e):(d=6*t-12*r+6*a,_=-3*t+9*r-9*a+3*o,c=3*r-3*t),Math.abs(_)<1e-12){if(Math.abs(d)<1e-12)continue;u=-c/d,0<u&&u<1&&l.push(u);continue}x=d*d-4*c*_,p=Math.sqrt(x),!(x<0)&&(g=(-d+p)/(2*_),0<g&&g<1&&l.push(g),y=(-d-p)/(2*_),0<y&&y<1&&l.push(y))}for(var k=l.length,T=k,S;k--;)u=l[k],S=1-u,h[0][k]=S*S*S*e+3*S*S*u*i+3*S*u*u*s+u*u*u*n,h[1][k]=S*S*S*t+3*S*S*u*r+3*S*u*u*a+u*u*u*o;return h[0][T]=e,h[1][T]=t,h[0][T+1]=n,h[1][T+1]=o,h[0].length=h[1].length=T+2,{min:{x:Math.min.apply(0,h[0]),y:Math.min.apply(0,h[1])},max:{x:Math.max.apply(0,h[0]),y:Math.max.apply(0,h[1])}}},di=function(e,t,i,r){for(var s=Ke.abscissas[r-2],a=Ke.weights[r-2],n=.5*(i-t),o=n+t,l=0,h=r+1>>1,_=r&1?a[l++]*e(o):0;l<h;){var d=n*s[l];_+=a[l++]*(e(o+d)+e(o-d))}return n*_},jt=function(e,t){for(var i=e.length,r=i-1,s=0;s<i;s++){var a=e[s];f.isObject(a.controls)||M.AppendCurveProperties(a);var n=t?re(s-1,i):Math.max(s-1,0),o=t?re(s+1,i):Math.min(s+1,r),l=e[n],h=a,_=e[o];_i(l,h,_),h.command=s===0?b.move:b.curve}},_i=function(e,t,i){var r=w.angleBetween(e,t),s=w.angleBetween(i,t),a=w.distanceBetween(e,t),n=w.distanceBetween(i,t),o=(r+s)/2;return a<1e-4||n<1e-4?(typeof t.relative=="boolean"&&!t.relative&&(t.controls.left.copy(t),t.controls.right.copy(t)),t):(a*=.33,n*=.33,s<r?o+=J:o-=J,t.controls.left.x=Math.cos(o)*a,t.controls.left.y=Math.sin(o)*a,o-=Math.PI,t.controls.right.x=Math.cos(o)*n,t.controls.right.y=Math.sin(o)*n,typeof t.relative=="boolean"&&!t.relative&&(t.controls.left.x+=t.x,t.controls.left.y+=t.y,t.controls.right.x+=t.x,t.controls.right.y+=t.y),t)},ct=function(e,t,i){return new w(2*e.x-(t.x+e.x)-(i?e.x:0),2*e.y-(t.y+e.y)-(i?e.y:0))},qi=function(e,t,i,r,s,a,n){for(var o=ee.Resolution,l=[],h=0;h<o;h++){var _=(h+1)/o;n&&(_=1-_);var d=_*a+s,c=i*Math.cos(d),u=r*Math.sin(d),g=new M(c,u);M.AppendCurveProperties(g),g.command=b.line,l.push(g)}};var Ki=D.devicePixelRatio||1,Ji=function(e){return e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1},$i=function(e){return Ki/Ji(e)},Ze=$i;var Zi=Math.cos,Qi=Math.sin,pi=Math.tan,Ht=[];function oe(e,t,i,r,s,a){this.elements=new ye(9);var n=e;Array.isArray(n)||(n=Array.prototype.slice.call(arguments)),this.identity(),n.length>0&&this.set(n)}It(oe);f.extend(oe,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(e,t,i){if(t.length<=3){var r,s,a,n=e,o=t[0]||0,l=t[1]||0,h=t[2]||0;return r=n[0]*o+n[1]*l+n[2]*h,s=n[3]*o+n[4]*l+n[5]*h,a=n[6]*o+n[7]*l+n[8]*h,{x:r,y:s,z:a}}var _=e[0],d=e[1],c=e[2],u=e[3],g=e[4],y=e[5],x=e[6],p=e[7],v=e[8],k=t[0],T=t[1],S=t[2],R=t[3],C=t[4],E=t[5],O=t[6],F=t[7],I=t[8];return i=i||new ye(9),i[0]=_*k+d*R+c*O,i[1]=_*T+d*C+c*F,i[2]=_*S+d*E+c*I,i[3]=u*k+g*R+y*O,i[4]=u*T+g*C+y*F,i[5]=u*S+g*E+y*I,i[6]=x*k+p*R+v*O,i[7]=x*T+p*C+v*F,i[8]=x*S+p*E+v*I,i}});f.extend(oe.prototype,m,{constructor:oe,manual:!1,set:function(e,t,i,r,s,a,n,o,l){var h;return typeof t=="undefined"&&(h=e,e=h[0],t=h[1],i=h[2],r=h[3],s=h[4],a=h[5],n=h[6],o=h[7],l=h[8]),this.elements[0]=e,this.elements[1]=t,this.elements[2]=i,this.elements[3]=r,this.elements[4]=s,this.elements[5]=a,this.elements[6]=n,this.elements[7]=o,this.elements[8]=l,this.trigger(m.Types.change)},copy:function(e){return this.elements[0]=e.elements[0],this.elements[1]=e.elements[1],this.elements[2]=e.elements[2],this.elements[3]=e.elements[3],this.elements[4]=e.elements[4],this.elements[5]=e.elements[5],this.elements[6]=e.elements[6],this.elements[7]=e.elements[7],this.elements[8]=e.elements[8],this.manual=e.manual,this.trigger(m.Types.change)},identity:function(){return this.elements[0]=oe.Identity[0],this.elements[1]=oe.Identity[1],this.elements[2]=oe.Identity[2],this.elements[3]=oe.Identity[3],this.elements[4]=oe.Identity[4],this.elements[5]=oe.Identity[5],this.elements[6]=oe.Identity[6],this.elements[7]=oe.Identity[7],this.elements[8]=oe.Identity[8],this.trigger(m.Types.change)},multiply:function(e,t,i,r,s,a,n,o,l){if(typeof t=="undefined")return this.elements[0]*=e,this.elements[1]*=e,this.elements[2]*=e,this.elements[3]*=e,this.elements[4]*=e,this.elements[5]*=e,this.elements[6]*=e,this.elements[7]*=e,this.elements[8]*=e,this.trigger(m.Types.change);if(typeof r=="undefined"){var h,_,d;return e=e||0,t=t||0,i=i||0,s=this.elements,h=s[0]*e+s[1]*t+s[2]*i,_=s[3]*e+s[4]*t+s[5]*i,d=s[6]*e+s[7]*t+s[8]*i,{x:h,y:_,z:d}}var c=this.elements,u=[e,t,i,r,s,a,n,o,l],g=c[0],y=c[1],x=c[2],p=c[3],v=c[4],k=c[5],T=c[6],S=c[7],R=c[8],C=u[0],E=u[1],O=u[2],F=u[3],I=u[4],j=u[5],X=u[6],z=u[7],ne=u[8];return this.elements[0]=g*C+y*F+x*X,this.elements[1]=g*E+y*I+x*z,this.elements[2]=g*O+y*j+x*ne,this.elements[3]=p*C+v*F+k*X,this.elements[4]=p*E+v*I+k*z,this.elements[5]=p*O+v*j+k*ne,this.elements[6]=T*C+S*F+R*X,this.elements[7]=T*E+S*I+R*z,this.elements[8]=T*O+S*j+R*ne,this.trigger(m.Types.change)},inverse:function(e){var t=this.elements;e=e||new oe;var i=t[0],r=t[1],s=t[2],a=t[3],n=t[4],o=t[5],l=t[6],h=t[7],_=t[8],d=_*n-o*h,c=-_*a+o*l,u=h*a-n*l,g=i*d+r*c+s*u;return g?(g=1/g,e.elements[0]=d*g,e.elements[1]=(-_*r+s*h)*g,e.elements[2]=(o*r-s*n)*g,e.elements[3]=c*g,e.elements[4]=(_*i-s*l)*g,e.elements[5]=(-o*i+s*a)*g,e.elements[6]=u*g,e.elements[7]=(-h*i+r*l)*g,e.elements[8]=(n*i-r*a)*g,e):null},scale:function(e,t){var i=arguments.length;return i<=1&&(t=e),this.multiply(e,0,0,0,t,0,0,0,1)},rotate:function(e){var t=Zi(e),i=Qi(e);return this.multiply(t,-i,0,i,t,0,0,0,1)},translate:function(e,t){return this.multiply(1,0,e,0,1,t,0,0,1)},skewX:function(e){var t=pi(e);return this.multiply(1,t,0,0,1,0,0,0,1)},skewY:function(e){var t=pi(e);return this.multiply(1,0,0,t,1,0,0,0,1)},toString:function(e){return Ht.length=0,this.toTransformArray(e,Ht),Ht.map(q).join(" ")},toTransformArray:function(e,t){var i=this.elements,r=!!t,s=i[0],a=i[1],n=i[2],o=i[3],l=i[4],h=i[5];if(e){var _=i[6],d=i[7],c=i[8];if(r){t[0]=s,t[1]=o,t[2]=_,t[3]=a,t[4]=l,t[5]=d,t[6]=n,t[7]=h,t[8]=c;return}return[s,o,_,a,l,d,n,h,c]}if(r){t[0]=s,t[1]=o,t[2]=a,t[3]=l,t[4]=n,t[5]=h;return}return[s,o,a,l,n,h]},toArray:function(e,t){var i=this.elements,r=!!t,s=i[0],a=i[1],n=i[2],o=i[3],l=i[4],h=i[5];if(e){var _=i[6],d=i[7],c=i[8];if(r){t[0]=s,t[1]=a,t[2]=n,t[3]=o,t[4]=l,t[5]=h,t[6]=_,t[7]=d,t[8]=c;return}return[s,a,n,o,l,h,_,d,c]}if(r){t[0]=s,t[1]=a,t[2]=n,t[3]=o,t[4]=l,t[5]=h;return}return[s,a,n,o,l,h]},toObject:function(){return{elements:this.toArray(!0),manual:!!this.manual}},clone:function(){return new oe().copy(this)}});var Ae=oe;function Le(){this.renderer={},this._renderer.flagMatrix=Le.FlagMatrix.bind(this),this.isShape=!0,this.id=ee.Identifier+ee.uniqueId(),this.classList=[],this.matrix=new Ae,this.translation=new w,this.rotation=0,this.scale=1,this.skewX=0,this.skewY=0}f.extend(Le,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(e){var t={enumerable:!1,get:function(){return this._translation},set:function(i){this._translation&&this._translation.unbind(m.Types.change,this._renderer.flagMatrix),this._translation=i,this._translation.bind(m.Types.change,this._renderer.flagMatrix),Le.FlagMatrix.call(this)}};Object.defineProperty(e,"translation",t),Object.defineProperty(e,"position",t),Object.defineProperty(e,"rotation",{enumerable:!0,get:function(){return this._rotation},set:function(i){this._rotation=i,this._flagMatrix=!0}}),Object.defineProperty(e,"scale",{enumerable:!0,get:function(){return this._scale},set:function(i){this._scale instanceof w&&this._scale.unbind(m.Types.change,this._renderer.flagMatrix),this._scale=i,this._scale instanceof w&&this._scale.bind(m.Types.change,this._renderer.flagMatrix),this._flagMatrix=!0,this._flagScale=!0}}),Object.defineProperty(e,"skewX",{enumerable:!0,get:function(){return this._skewX},set:function(i){this._skewX=i,this._flagMatrix=!0}}),Object.defineProperty(e,"skewY",{enumerable:!0,get:function(){return this._skewY},set:function(i){this._skewY=i,this._flagMatrix=!0}}),Object.defineProperty(e,"matrix",{enumerable:!0,get:function(){return this._matrix},set:function(i){this._matrix=i,this._flagMatrix=!0}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return this._id},set:function(i){var r=this._id;i!==this._id&&(this._id=i,this._flagId=!0,this.parent&&(delete this.parent.children.ids[r],this.parent.children.ids[this._id]=this))}}),Object.defineProperty(e,"className",{enumerable:!0,get:function(){return this._className},set:function(i){if(this._flagClassName=this._className!==i,this._flagClassName){for(var r=this._className.split(/\s+?/),s=i.split(/\s+?/),a=0;a<r.length;a++){var n=r[a],o=Array.prototype.indexOf.call(this.classList,n);o>=0&&this.classList.splice(o,1)}this.classList=this.classList.concat(s)}this._className=i}}),Object.defineProperty(e,"renderer",{enumerable:!1,get:function(){return this._renderer},set:function(i){this._renderer=i}})}});f.extend(Le.prototype,m,{constructor:Le,_flagId:!0,_flagMatrix:!0,_flagScale:!1,_flagClassName:!1,_id:"",_translation:null,_rotation:0,_scale:1,_skewX:0,_skewY:0,_className:"",addTo:function(e){return e.add(this),this},clone:function(e){var t=new Le;return t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()},_update:function(e){return!this._matrix.manual&&this._flagMatrix&&(this._matrix.identity().translate(this.translation.x,this.translation.y),this._scale instanceof w?this._matrix.scale(this._scale.x,this._scale.y):this._matrix.scale(this._scale),this._matrix.rotate(this.rotation),this._matrix.skewX(this.skewX),this._matrix.skewY(this.skewY)),e&&this.parent&&this.parent._update&&this.parent._update(),this},flagReset:function(){return this._flagId=this._flagMatrix=this._flagScale=this._flagClassName=!1,this}});Le.MakeObservable(Le.prototype);var Y=Le;function ut(){Array.call(this),arguments[0]&&Array.isArray(arguments[0])?arguments[0].length>0&&Array.prototype.push.apply(this,arguments[0]):arguments.length>0&&Array.prototype.push.apply(this,arguments)}ut.prototype=new Array;f.extend(ut.prototype,m,{constructor:ut,pop:function(){var e=Array.prototype.pop.apply(this,arguments);return this.trigger(m.Types.remove,[e]),e},shift:function(){var e=Array.prototype.shift.apply(this,arguments);return this.trigger(m.Types.remove,[e]),e},push:function(){var e=Array.prototype.push.apply(this,arguments);return this.trigger(m.Types.insert,arguments),e},unshift:function(){var e=Array.prototype.unshift.apply(this,arguments);return this.trigger(m.Types.insert,arguments),e},splice:function(){var e=Array.prototype.splice.apply(this,arguments),t;return this.trigger(m.Types.remove,e),arguments.length>2&&(t=this.slice(arguments[0],arguments[0]+arguments.length-2),this.trigger(m.Types.insert,t),this.trigger(m.Types.order)),e},sort:function(){return Array.prototype.sort.apply(this,arguments),this.trigger(m.Types.order),this},reverse:function(){return Array.prototype.reverse.apply(this,arguments),this.trigger(m.Types.order),this},indexOf:function(){return Array.prototype.indexOf.apply(this,arguments)}});var fe=ut;function dt(e){fe.apply(this,arguments),Object.defineProperty(this,"_events",{value:{},enumerable:!1}),this.ids={},this.attach(Array.isArray(e)?e:Array.prototype.slice.call(arguments)),this.on(m.Types.insert,this.attach),this.on(m.Types.remove,this.detach)}dt.prototype=new fe;f.extend(dt.prototype,{constructor:dt,attach:function(e){for(var t=0;t<e.length;t++){var i=e[t];i&&i.id&&(this.ids[i.id]=i)}return this},detach:function(e){for(var t=0;t<e.length;t++)delete this.ids[e[t].id];return this}});var Wt=dt;var _t=Math.min,pt=Math.max;function pe(e){Y.call(this),this._renderer.type="group",this.additions=[],this.subtractions=[],this.children=Array.isArray(e)?e:Array.prototype.slice.call(arguments)}f.extend(pe,{Children:Wt,InsertChildren:function(e){for(var t=0;t<e.length;t++)gi.call(this,e[t],this)},RemoveChildren:function(e){for(var t=0;t<e.length;t++)gi.call(this,e[t])},OrderChildren:function(e){this._flagOrder=!0},Properties:["fill","stroke","linewidth","cap","join","miter","closed","curved","automatic"],MakeObservable:function(e){var t=pe.Properties;Object.defineProperty(e,"visible",{enumerable:!0,get:function(){return this._visible},set:function(i){this._flagVisible=this._visible!==i||this._flagVisible,this._visible=i}}),Object.defineProperty(e,"opacity",{enumerable:!0,get:function(){return this._opacity},set:function(i){this._flagOpacity=this._opacity!==i||this._flagOpacity,this._opacity=i}}),Object.defineProperty(e,"beginning",{enumerable:!0,get:function(){return this._beginning},set:function(i){this._flagBeginning=this._beginning!==i||this._flagBeginning,this._beginning=i}}),Object.defineProperty(e,"ending",{enumerable:!0,get:function(){return this._ending},set:function(i){this._flagEnding=this._ending!==i||this._flagEnding,this._ending=i}}),Object.defineProperty(e,"length",{enumerable:!0,get:function(){if(this._flagLength||this._length<=0){if(this._length=0,!this.children)return this._length;for(var i=0;i<this.children.length;i++){var r=this.children[i];this._length+=r.length}}return this._length}}),Y.MakeObservable(e),pe.MakeGetterSetters(e,t),Object.defineProperty(e,"children",{enumerable:!0,get:function(){return this._children},set:function(i){var r=pe.InsertChildren.bind(this),s=pe.RemoveChildren.bind(this),a=pe.OrderChildren.bind(this);this._children&&(this._children.unbind(),this._children.length>0&&s(this._children)),this._children=new Wt(i),this._children.bind(m.Types.insert,r),this._children.bind(m.Types.remove,s),this._children.bind(m.Types.order,a),i.length>0&&r(i)}}),Object.defineProperty(e,"mask",{enumerable:!0,get:function(){return this._mask},set:function(i){this._mask&&(this._mask.clip=!1),this._mask=i,this._flagMask=!0,i&&!i.clip&&(i.clip=!0)}})},MakeGetterSetters:function(e,t){Array.isArray(t)||(t=[t]),f.each(t,function(i){pe.MakeGetterSetter(e,i)})},MakeGetterSetter:function(e,t){var i="_"+t;Object.defineProperty(e,t,{enumerable:!0,get:function(){return this[i]},set:function(r){this[i]=r;for(var s=0;s<this.children.length;s++){var a=this.children[s];a[t]=r}}})}});f.extend(pe.prototype,Y.prototype,{constructor:pe,_flagAdditions:!1,_flagSubtractions:!1,_flagOrder:!1,_flagOpacity:!0,_flagBeginning:!1,_flagEnding:!1,_flagLength:!1,_flagMask:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,_length:0,_mask:null,clone:function(e){var t=new pe,i=this.children.map(function(r){return r.clone()});return t.add(i),t.opacity=this.opacity,this.mask&&(t.mask=this.mask),t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.className=this.className,this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()},toObject:function(){var e={children:[],translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale instanceof w?this.scale.toObject():this.scale,opacity:this.opacity,className:this.className,mask:this.mask?this.mask.toObject():null};return this.matrix.manual&&(e.matrix=this.matrix.toObject()),f.each(this.children,function(t,i){e.children[i]=t.toObject()},this),e},corner:function(){for(var e=this.getBoundingClientRect(!0),t=0;t<this.children.length;t++){var i=this.children[t];i.translation.x-=e.left,i.translation.y-=e.top}return this.mask&&(this.mask.translation.x-=e.left,this.mask.translation.y-=e.top),this},center:function(){for(var e=this.getBoundingClientRect(!0),t=e.left+e.width/2-this.translation.x,i=e.top+e.height/2-this.translation.y,r=0;r<this.children.length;r++){var s=this.children[r];s.isShape&&(s.translation.x-=t,s.translation.y-=i)}return this.mask&&(this.mask.translation.x-=t,this.mask.translation.y-=i),this},getById:function(e){var t=null;function i(r){if(r.id===e)return r;if(r.children){for(var s=0;s<r.children.length;s++)if(t=i(r.children[s]),t)return t}return null}return i(this)},getByClassName:function(e){var t=[];function i(r){if(Array.prototype.indexOf.call(r.classList,e)>=0&&t.push(r),r.children)for(var s=0;s<r.children.length;s++){var a=r.children[s];i(a)}return t}return i(this)},getByType:function(e){var t=[];function i(r){if(r instanceof e&&t.push(r),r.children)for(var s=0;s<r.children.length;s++){var a=r.children[s];i(a)}return t}return i(this)},add:function(e){e instanceof Array?e=e.slice():e=Array.prototype.slice.call(arguments);for(var t=0;t<e.length;t++){var i=e[t];if(!!(i&&i.id)){var r=Array.prototype.indexOf.call(this.children,i);r>=0&&this.children.splice(r,1),this.children.push(i)}}return this},remove:function(e){var t=arguments.length,i=this.parent;if(t<=0&&i)return i.remove(this),this;e instanceof Array?e=e.slice():e=Array.prototype.slice.call(arguments);for(var r=0;r<e.length;r++){var s=e[r];if(!(!s||!this.children.ids[s.id])){var a=this.children.indexOf(s);a>=0&&this.children.splice(a,1)}}return this},getBoundingClientRect:function(e){var t,i,r,s,a,n,o,l,h,_;this._update(!0);var d=1/0,c=-1/0,u=1/0,g=-1/0,y=/texture|gradient/i;i=e?this._matrix:Se(this);for(var x=0;x<this.children.length;x++){var p=this.children[x];!p.visible||y.test(p._renderer.type)||(t=p.getBoundingClientRect(e),o=typeof t.top!="number"||f.isNaN(t.top)||!isFinite(t.top),l=typeof t.left!="number"||f.isNaN(t.left)||!isFinite(t.left),h=typeof t.right!="number"||f.isNaN(t.right)||!isFinite(t.right),_=typeof t.bottom!="number"||f.isNaN(t.bottom)||!isFinite(t.bottom),!(o||l||h||_)&&(u=_t(t.top,u),d=_t(t.left,d),c=pt(t.right,c),g=pt(t.bottom,g)))}return e&&(r=i.multiply(d,u,1),s=i.multiply(d,g,1),a=i.multiply(c,u,1),n=i.multiply(c,g,1),u=_t(r.y,s.y,a.y,n.y),d=_t(r.x,s.x,a.x,n.x),c=pt(r.x,s.x,a.x,n.x),g=pt(r.y,s.y,a.y,n.y)),{top:u,left:d,right:c,bottom:g,width:c-d,height:g-u}},noFill:function(){return this.children.forEach(function(e){e.noFill()}),this},noStroke:function(){return this.children.forEach(function(e){e.noStroke()}),this},subdivide:function(){var e=arguments;return this.children.forEach(function(t){t.subdivide.apply(t,e)}),this},_update:function(){var e,t,i;if(this._flagBeginning||this._flagEnding){var r=Math.min(this._beginning,this._ending),s=Math.max(this._beginning,this._ending),a=this.length,n=0,o=r*a,l=s*a;for(e=0;e<this.children.length;e++)i=this.children[e],t=i.length,o>n+t?(i.beginning=1,i.ending=1):l<n?(i.beginning=0,i.ending=0):o>n&&o<n+t?(i.beginning=(o-n)/t,i.ending=1):l>n&&l<n+t?(i.beginning=0,i.ending=(l-n)/t):(i.beginning=0,i.ending=1),n+=t}return Y.prototype._update.apply(this,arguments)},flagReset:function(){return this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1),this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1),this._flagOrder=this._flagMask=this._flagOpacity=this._flagBeginning=this._flagEnding=!1,Y.prototype.flagReset.call(this),this}});pe.MakeObservable(pe.prototype);function gi(e,t){var i=e.parent,r;if(i===t){s();return}if(i&&i.children.ids[e.id]&&(r=Array.prototype.indexOf.call(i.children,e),i.children.splice(r,1),a()),t){s();return}a(),i._flagAdditions&&i.additions.length===0&&(i._flagAdditions=!1),i._flagSubtractions&&i.subtractions.length===0&&(i._flagSubtractions=!1),delete e.parent;function s(){t.subtractions.length>0&&(r=Array.prototype.indexOf.call(t.subtractions,e),r>=0&&t.subtractions.splice(r,1)),t.additions.length>0&&(r=Array.prototype.indexOf.call(t.additions,e),r>=0&&t.additions.splice(r,1)),e.parent=t,t.additions.push(e),t._flagAdditions=!0}function a(){r=Array.prototype.indexOf.call(i.additions,e),r>=0&&i.additions.splice(r,1),r=Array.prototype.indexOf.call(i.subtractions,e),r<0&&(i.subtractions.push(e),i._flagSubtractions=!0)}}var te=pe;var mi=new Ae,Xt=[],Yt=Math.max,er=Math.min,vi=Math.abs,gt=Math.sin,mt=Math.cos,tr=Math.acos,vt=Math.sqrt,yt=function(e){return e[0]==1&&e[3]==0&&e[1]==0&&e[4]==1&&e[2]==0&&e[5]==0},Z={isHidden:/(undefined|none|transparent)/i,alignments:{left:"start",middle:"center",right:"end"},shim:function(e,t){return e.tagName=e.nodeName=t||"canvas",e.nodeType=1,e.getAttribute=function(i){return this[i]},e.setAttribute=function(i,r){return this[i]=r,this},e},group:{renderChild:function(e){Z[e._renderer.type].render.call(e,this.ctx,!0,this.clip)},render:function(e){if(!this._visible)return this;this._update();var t=this._matrix.elements,i=this.parent;this._renderer.opacity=this._opacity*(i&&i._renderer?i._renderer.opacity:1);var r=this._mask,s=yt(t),a=!s||!!r;if(this._renderer.context||(this._renderer.context={}),this._renderer.context.ctx=e,a&&(e.save(),s||e.transform(t[0],t[3],t[1],t[4],t[2],t[5])),r&&Z[r._renderer.type].render.call(r,e,!0),this._opacity>0&&this._scale!==0)for(var n=0;n<this.children.length;n++){var o=this.children[n];Z[o._renderer.type].render.call(o,e)}return a&&e.restore(),this.flagReset()}},path:{render:function(e,t,i){var r,s,a,n,o,l,h,_,d,c,u,g,y,x,p,v,k,T,S,R,C,E,O,F,I,j,X,z,ne,ke,we,Q,G,Je;if(Je=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,ne=this._mask,ke=this._clip,o=this._opacity*(Je||1),l=this._visible,!t&&(!l||ke||o===0))return this;this._update(),r=this._matrix.elements,s=this._stroke,a=this._linewidth,n=this._fill,h=this._cap,_=this._join,d=this._miter,c=this._closed,u=this._renderer.vertices,g=u.length,y=g-1,we=yt(r),G=this.dashes,we||(e.save(),e.transform(r[0],r[3],r[1],r[4],r[2],r[5])),ne&&Z[ne._renderer.type].render.call(ne,e,!0),n&&(typeof n=="string"?e.fillStyle=n:(Z[n._renderer.type].render.call(n,e,this),e.fillStyle=n._renderer.effect)),s&&(typeof s=="string"?e.strokeStyle=s:(Z[s._renderer.type].render.call(s,e,this),e.strokeStyle=s._renderer.effect),a&&(e.lineWidth=a),d&&(e.miterLimit=d),_&&(e.lineJoin=_),!c&&h&&(e.lineCap=h)),typeof o=="number"&&(e.globalAlpha=o),G&&G.length>0&&(e.lineDashOffset=G.offset||0,e.setLineDash(G)),e.beginPath();for(var ie=0;ie<g;ie++)switch(v=u[ie],X=v.x,z=v.y,v.command){case b.close:e.closePath();break;case b.arc:var Rt=v.rx,Ot=v.ry,Ft=v.xAxisRotation,Ct=v.largeArcFlag,Pt=v.sweepFlag;x=c?re(ie-1,g):Yt(ie-1,0),p=u[x];var Fi=p.x,Ci=p.y;Z.renderSvgArcCommand(e,Fi,Ci,Rt,Ot,Ct,Pt,Ft,X,z);break;case b.curve:x=c?re(ie-1,g):Math.max(ie-1,0),p=u[x],O=p.controls&&p.controls.right||w.zero,F=v.controls&&v.controls.left||w.zero,p._relative?(C=O.x+p.x,E=O.y+p.y):(C=O.x,E=O.y),v._relative?(S=F.x+v.x,R=F.y+v.y):(S=F.x,R=F.y),e.bezierCurveTo(C,E,S,R,X,z),ie>=y&&c&&(k=T,I=v.controls&&v.controls.right||w.zero,j=k.controls&&k.controls.left||w.zero,v._relative?(C=I.x+v.x,E=I.y+v.y):(C=I.x,E=I.y),k._relative?(S=j.x+k.x,R=j.y+k.y):(S=j.x,R=j.y),X=k.x,z=k.y,e.bezierCurveTo(C,E,S,R,X,z));break;case b.line:e.lineTo(X,z);break;case b.move:T=v,e.moveTo(X,z);break}return c&&e.closePath(),!ke&&!i&&(Z.isHidden.test(n)||(Q=n._renderer&&n._renderer.offset,Q&&(e.save(),e.translate(-n._renderer.offset.x,-n._renderer.offset.y),e.scale(n._renderer.scale.x,n._renderer.scale.y)),e.fill(),Q&&e.restore()),Z.isHidden.test(s)||(Q=s._renderer&&s._renderer.offset,Q&&(e.save(),e.translate(-s._renderer.offset.x,-s._renderer.offset.y),e.scale(s._renderer.scale.x,s._renderer.scale.y),e.lineWidth=a/s._renderer.scale.x),e.stroke(),Q&&e.restore())),we||e.restore(),ke&&!i&&e.clip(),G&&G.length>0&&e.setLineDash(Xt),this.flagReset()}},points:{render:function(e,t,i){var r,s,a,n,o,l,h,_,d,c,u,g,y,x,p,v;if(v=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,o=this._opacity*(v||1),l=this._visible,!t&&(!l||o===0))return this;this._update(),r=this._matrix.elements,s=this._stroke,a=this._linewidth,n=this._fill,_=this._renderer.collection,d=_.length,y=yt(r),p=this.dashes,h=this._size,y||(e.save(),e.transform(r[0],r[3],r[1],r[4],r[2],r[5])),n&&(typeof n=="string"?e.fillStyle=n:(Z[n._renderer.type].render.call(n,e,this),e.fillStyle=n._renderer.effect)),s&&(typeof s=="string"?e.strokeStyle=s:(Z[s._renderer.type].render.call(s,e,this),e.strokeStyle=s._renderer.effect),a&&(e.lineWidth=a)),typeof o=="number"&&(e.globalAlpha=o),p&&p.length>0&&(e.lineDashOffset=p.offset||0,e.setLineDash(p)),e.beginPath();var k=h*.5,T;this._sizeAttenuation||(Se(this,mi),T=mi.elements,T=Ge(T[0],T[3],T[1],T[4],T[2],T[5]),k/=Math.max(T.scaleX,T.scaleY));for(var S=0;S<d;S++)c=_[S],u=c.x,g=c.y,e.moveTo(u+k,g),e.arc(u,g,k,0,K);return i||(Z.isHidden.test(n)||(x=n._renderer&&n._renderer.offset,x&&(e.save(),e.translate(-n._renderer.offset.x,-n._renderer.offset.y),e.scale(n._renderer.scale.x,n._renderer.scale.y)),e.fill(),x&&e.restore()),Z.isHidden.test(s)||(x=s._renderer&&s._renderer.offset,x&&(e.save(),e.translate(-s._renderer.offset.x,-s._renderer.offset.y),e.scale(s._renderer.scale.x,s._renderer.scale.y),e.lineWidth=a/s._renderer.scale.x),e.stroke(),x&&e.restore())),y||e.restore(),p&&p.length>0&&e.setLineDash(Xt),this.flagReset()}},text:{render:function(e,t,i){var r=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,s=this._opacity*r,a=this._visible,n=this._mask,o=this._clip;if(!t&&(!a||o||s===0))return this;this._update();var l=this._matrix.elements,h=this._stroke,_=this._linewidth,d=this._fill,c=this._decoration,u=yt(l),g=d._renderer&&d._renderer.offset&&h._renderer&&h._renderer.offset,y=this.dashes,x=Z.alignments[this._alignment]||this._alignment,p=this._baseline,v,k,T,S,R,C,E,O,F,I,j;if(u||(e.save(),e.transform(l[0],l[3],l[1],l[4],l[2],l[5])),n&&Z[n._renderer.type].render.call(n,e,!0),g||(e.font=[this._style,this._weight,this._size+"px/"+this._leading+"px",this._family].join(" ")),e.textAlign=x,e.textBaseline=p,d&&(typeof d=="string"?e.fillStyle=d:(Z[d._renderer.type].render.call(d,e,this),e.fillStyle=d._renderer.effect)),h&&(typeof h=="string"?e.strokeStyle=h:(Z[h._renderer.type].render.call(h,e,this),e.strokeStyle=h._renderer.effect),_&&(e.lineWidth=_)),typeof s=="number"&&(e.globalAlpha=s),y&&y.length>0&&(e.lineDashOffset=y.offset||0,e.setLineDash(y)),!o&&!i&&(Z.isHidden.test(d)||(d._renderer&&d._renderer.offset?(C=d._renderer.scale.x,E=d._renderer.scale.y,e.save(),e.translate(-d._renderer.offset.x,-d._renderer.offset.y),e.scale(C,E),v=this._size/d._renderer.scale.y,k=this._leading/d._renderer.scale.y,e.font=[this._style,this._weight,v+"px/",k+"px",this._family].join(" "),T=d._renderer.offset.x/d._renderer.scale.x,S=d._renderer.offset.y/d._renderer.scale.y,e.fillText(this.value,T,S),e.restore()):e.fillText(this.value,0,0)),Z.isHidden.test(h)||(h._renderer&&h._renderer.offset?(C=h._renderer.scale.x,E=h._renderer.scale.y,e.save(),e.translate(-h._renderer.offset.x,-h._renderer.offset.y),e.scale(C,E),v=this._size/h._renderer.scale.y,k=this._leading/h._renderer.scale.y,e.font=[this._style,this._weight,v+"px/",k+"px",this._family].join(" "),T=h._renderer.offset.x/h._renderer.scale.x,S=h._renderer.offset.y/h._renderer.scale.y,R=_/h._renderer.scale.x,e.lineWidth=R,e.strokeText(this.value,T,S),e.restore()):e.strokeText(this.value,0,0))),/(underline|strikethrough)/i.test(c)){var X=e.measureText(this.value),z=1;switch(c){case"underline":F=X.actualBoundingBoxAscent,j=X.actualBoundingBoxAscent;break;case"strikethrough":F=0,j=0,z=.5;break}switch(p){case"top":F+=this._size*z,j+=this._size*z;break;case"baseline":case"bottom":F-=this._size*z,j-=this._size*z;break}switch(x){case"left":case"start":O=0,I=X.width;break;case"right":case"end":O=-X.width,I=0;break;default:O=-X.width/2,I=X.width/2}e.lineWidth=Math.max(Math.floor(this._size/15),1),e.strokeStyle=e.fillStyle,e.beginPath(),e.moveTo(O,F),e.lineTo(I,j),e.stroke()}return u||e.restore(),o&&!i&&e.clip(),y&&y.length>0&&e.setLineDash(Xt),this.flagReset()}},"linear-gradient":{render:function(e,t){if(!!t){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){var i,r=this.left._x,s=this.left._y,a=this.right._x,n=this.right._y;/objectBoundingBox/i.test(this._units)&&(i=t.getBoundingClientRect(!0),r=(r-.5)*i.width,s=(s-.5)*i.height,a=(a-.5)*i.width,n=(n-.5)*i.height),this._renderer.effect=e.createLinearGradient(r,s,a,n);for(var o=0;o<this.stops.length;o++){var l=this.stops[o];this._renderer.effect.addColorStop(l._offset,l._color)}}return this.flagReset()}}},"radial-gradient":{render:function(e,t){if(!!t){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){var i,r=this.center._x,s=this.center._y,a=this.focal._x,n=this.focal._y,o=this._radius;/objectBoundingBox/i.test(this._units)&&(i=t.getBoundingClientRect(!0),r=r*i.width*.5,s=s*i.height*.5,a=a*i.width*.5,n=n*i.height*.5,o*=Math.min(i.width,i.height)*.5),this._renderer.effect=e.createRadialGradient(r,s,0,a,n,o);for(var l=0;l<this.stops.length;l++){var h=this.stops[l];this._renderer.effect.addColorStop(h._offset,h._color)}}return this.flagReset()}}},texture:{render:function(e){this._update();var t=this.image;return(!this._renderer.effect||(this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)&&(this._renderer.effect=e.createPattern(this.image,this._repeat)),(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof w||(this._renderer.offset=new w),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,t&&(this._renderer.offset.x+=t.width/2,this._renderer.offset.y+=t.height/2,this._scale instanceof w?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof w||(this._renderer.scale=new w),this._scale instanceof w?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}},renderSvgArcCommand:function(e,t,i,r,s,a,n,o,l,h){o=o*Math.PI/180,r=vi(r),s=vi(s);var _=(t-l)/2,d=(i-h)/2,c=mt(o)*_+gt(o)*d,u=-gt(o)*_+mt(o)*d,g=r*r,y=s*s,x=c*c,p=u*u,v=x/g+p/y;if(v>1){var k=vt(v);r=k*r,s=k*s,g=r*r,y=s*s}var T=g*p+y*x,S=(g*y-T)/T,R=vt(Yt(0,S));a===n&&(R=-R);var C=R*r*u/s,E=-R*s*c/r,O=mt(o)*C-gt(o)*E+(t+l)/2,F=gt(o)*C+mt(o)*E+(i+h)/2,I=yi(1,0,(c-C)/r,(u-E)/s),j=yi((c-C)/r,(u-E)/s,(-c-C)/r,(-u-E)/s)%K,X=I+j,z=n===0;ir(e,O,F,r,s,I,X,z,o)}};function xt(e){var t=e.smoothing!==!1;this.domElement=e.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=e.overdraw||!1,typeof this.ctx.imageSmoothingEnabled!="undefined"&&(this.ctx.imageSmoothingEnabled=t),this.scene=new te,this.scene.parent=this}f.extend(xt,{Utils:Z});f.extend(xt.prototype,m,{constructor:xt,setSize:function(e,t,i){return this.width=e,this.height=t,this.ratio=typeof i=="undefined"?Ze(this.ctx):i,this.domElement.width=e*this.ratio,this.domElement.height=t*this.ratio,this.domElement.style&&f.extend(this.domElement.style,{width:e+"px",height:t+"px"}),this.trigger(m.Types.resize,e,t,i)},render:function(){var e=this.ratio===1;return e||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),Z.group.render.call(this.scene,this.ctx),e||this.ctx.restore(),this}});function ir(e,t,i,r,s,a,n,o,l){var h=Ke.Tolerance.epsilon,_=n-a,d=Math.abs(_)<h;_=re(_,K),_<h&&(d?_=0:_=K),o===!0&&!d&&(_===K?_=-K:_=_-K);for(var c=0;c<ee.Resolution;c++){var u=c/(ee.Resolution-1),g=a+u*_,y=t+r*Math.cos(g),x=i+s*Math.sin(g);if(l!==0){var p=Math.cos(l),v=Math.sin(l),k=y-t,T=x-i;y=k*p-T*v+t,x=k*v+T*p+i}e.lineTo(y,x)}}function yi(e,t,i,r){var s=e*i+t*r,a=vt(e*e+t*t)*vt(i*i+r*r),n=tr(Yt(-1,er(1,s/a)));return e*r-t*i<0&&(n=-n),n}var Ue=xt;var qt={Image:null,isHeadless:!1,shim:function(e,t){return Ue.Utils.shim(e),typeof t!="undefined"&&(qt.Image=t),qt.isHeadless=!0,e}},ge=qt;var tt={hasEventListeners:typeof D.addEventListener=="function",bind:function(e,t,i,r){return this.hasEventListeners?e.addEventListener(t,i,!!r):e.attachEvent("on"+t,i),tt},unbind:function(e,t,i,r){return tt.hasEventListeners?e.removeEventListeners(t,i,!!r):e.detachEvent("on"+t,i),tt},getRequestAnimationFrame:function(){var e=0,t=["ms","moz","webkit","o"],i=D.requestAnimationFrame,r;if(!i){for(var s=0;s<t.length;s++)i=D[t[s]+"RequestAnimationFrame"]||i,r=D[t[s]+"CancelAnimationFrame"]||D[t[s]+"CancelRequestAnimationFrame"]||r;i=i||function(a,n){var o=new Date().getTime(),l=Math.max(0,16-(o-e)),h=D.setTimeout(function(){a(o+l)},l);return e=o+l,h}}return i}},Qe=D.document?D.document.createElement("div"):{};Qe.id="help-two-load";Object.defineProperty(tt,"temp",{enumerable:!0,get:function(){return f.isElement(Qe)&&!D.document.head.contains(Qe)&&(f.extend(Qe.style,{display:"none"}),D.document.head.appendChild(Qe)),Qe}});var Fe=tt;function bt(e){this.name="Two.js",this.message=e}bt.prototype=new Error;f.extend(bt.prototype,{constructor:bt});var le=bt;var rr=function(e){var t=this,i="_"+e,r="_flag"+e.charAt(0).toUpperCase()+e.slice(1);Object.defineProperty(t,e,{enumerable:!0,get:function(){return this[i]},set:function(s){this[i]=s,this[r]=!0}})},N=rr;function Kt(){this.map={}}f.extend(Kt.prototype,{constructor:Kt,add:function(e,t){return this.map[e]=t,this},remove:function(e){return delete this.map[e],this},get:function(e){return this.map[e]},contains:function(e){return e in this.map}});var je=Kt;function ue(e,t,i){this.renderer={},this._renderer.type="stop",this.offset=typeof e=="number"?e:ue.Index<=0?0:1,this.opacity=typeof i=="number"?i:1,this.color=typeof t=="string"?t:ue.Index<=0?"#fff":"#000",ue.Index=(ue.Index+1)%2}f.extend(ue,{Index:0,Properties:["offset","opacity","color"],MakeObservable:function(e){f.each(ue.Properties,function(t){var i=this,r="_"+t,s="_flag"+t.charAt(0).toUpperCase()+t.slice(1);Object.defineProperty(i,t,{enumerable:!0,get:function(){return this[r]},set:function(a){this[r]=a,this[s]=!0,this.parent&&(this.parent._flagStops=!0)}})},e),Object.defineProperty(e,"renderer",{enumerable:!1,get:function(){return this._renderer},set:function(t){this._renderer=t}})}});f.extend(ue.prototype,m,{constructor:ue,clone:function(){var e=new ue;return f.each(ue.Properties,function(t){e[t]=this[t]},this),e},toObject:function(){var e={};return f.each(ue.Properties,function(t){e[t]=this[t]},this),e},flagReset:function(){return this._flagOffset=this._flagColor=this._flagOpacity=!1,this}});ue.MakeObservable(ue.prototype);var Te=ue;function me(e){this.renderer={},this._renderer.type="gradient",this.id=ee.Identifier+ee.uniqueId(),this.classList=[],this._renderer.flagStops=me.FlagStops.bind(this),this._renderer.bindStops=me.BindStops.bind(this),this._renderer.unbindStops=me.UnbindStops.bind(this),this.spread="pad",this.units="objectBoundingBox",e&&(this.stops=e)}f.extend(me,{Stop:Te,Properties:["spread","units"],MakeObservable:function(e){f.each(me.Properties,N,e),Object.defineProperty(e,"stops",{enumerable:!0,get:function(){return this._stops},set:function(t){var i=this._renderer.bindStops,r=this._renderer.unbindStops;this._stops&&this._stops.unbind(m.Types.insert,i).unbind(m.Types.remove,r),this._stops=new fe((t||[]).slice(0)),this._stops.bind(m.Types.insert,i).bind(m.Types.remove,r),i(this._stops)}}),Object.defineProperty(e,"renderer",{enumerable:!1,get:function(){return this._renderer},set:function(t){this._renderer=t}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return this._id},set:function(t){this._id=t}})},FlagStops:function(){this._flagStops=!0},BindStops:function(e){for(var t=e.length;t--;)e[t].bind(m.Types.change,this._renderer.flagStops),e[t].parent=this;this._renderer.flagStops()},UnbindStops:function(e){for(var t=e.length;t--;)e[t].unbind(m.Types.change,this._renderer.flagStops),delete e[t].parent;this._renderer.flagStops()}});f.extend(me.prototype,m,{constructor:me,_flagId:!1,_flagStops:!1,_flagSpread:!1,_flagUnits:!1,_id:"",_spread:"",_units:"",clone:function(e){var t=this.stops.map(function(r){return r.clone()}),i=new me(t);return f.each(me.Properties,function(r){i[r]=this[r]},this),e&&e.add(i),i},toObject:function(){var e={stops:this.stops.map(function(t){return t.toObject()})};return f.each(me.Properties,function(t){e[t]=this[t]},this),e},_update:function(){return(this._flagSpread||this._flagStops)&&this.trigger(m.Types.change),this},flagReset:function(){return this._flagSpread=this._flagUnits=this._flagStops=!1,this}});me.MakeObservable(me.prototype);var B=me;function De(e,t,i,r,s){B.call(this,s),this._renderer.type="linear-gradient";var a=De.FlagEndPoints.bind(this);this.left=new w().bind(m.Types.change,a),this.right=new w().bind(m.Types.change,a),typeof e=="number"&&(this.left.x=e),typeof t=="number"&&(this.left.y=t),typeof i=="number"&&(this.right.x=i),typeof r=="number"&&(this.right.y=r)}f.extend(De,{Stop:Te,MakeObservable:function(e){B.MakeObservable(e)},FlagEndPoints:function(){this._flagEndPoints=!0}});f.extend(De.prototype,B.prototype,{constructor:De,_flagEndPoints:!1,clone:function(e){var t=this.stops.map(function(r){return r.clone()}),i=new De(this.left._x,this.left._y,this.right._x,this.right._y,t);return f.each(B.Properties,function(r){i[r]=this[r]},this),e&&e.add(i),i},toObject:function(){var e=B.prototype.toObject.call(this);return e.left=this.left.toObject(),e.right=this.right.toObject(),e},_update:function(){return(this._flagEndPoints||this._flagSpread||this._flagStops)&&this.trigger(m.Types.change),this},flagReset:function(){return this._flagEndPoints=!1,B.prototype.flagReset.call(this),this}});De.MakeObservable(De.prototype);var H=De;function Ce(e,t,i,r,s,a){B.call(this,r),this._renderer.type="radial-gradient",this.center=new w().bind(m.Types.change,function(){this._flagCenter=!0}.bind(this)),this.radius=typeof i=="number"?i:20,this.focal=new w().bind(m.Types.change,function(){this._flagFocal=!0}.bind(this)),typeof e=="number"&&(this.center.x=e),typeof t=="number"&&(this.center.y=t),this.focal.copy(this.center),typeof s=="number"&&(this.focal.x=s),typeof a=="number"&&(this.focal.y=a)}f.extend(Ce,{Stop:Te,Properties:["radius"],MakeObservable:function(e){B.MakeObservable(e),f.each(Ce.Properties,N,e)}});f.extend(Ce.prototype,B.prototype,{constructor:Ce,_flagRadius:!1,_flagCenter:!1,_flagFocal:!1,clone:function(e){var t=this.stops.map(function(r){return r.clone()}),i=new Ce(this.center._x,this.center._y,this._radius,t,this.focal._x,this.focal._y);return f.each(B.Properties.concat(Ce.Properties),function(r){i[r]=this[r]},this),e&&e.add(i),i},toObject:function(){var e=B.prototype.toObject.call(this);return f.each(Ce.Properties,function(t){e[t]=this[t]},this),e.center=this.center.toObject(),e.focal=this.focal.toObject(),e},_update:function(){return(this._flagRadius||this._flatCenter||this._flagFocal||this._flagSpread||this._flagStops)&&this.trigger(m.Types.change),this},flagReset:function(){return this._flagRadius=this._flagCenter=this._flagFocal=!1,B.prototype.flagReset.call(this),this}});Ce.MakeObservable(Ce.prototype);var W=Ce;var kt,xi={video:/\.(mp4|webm|ogg)$/i,image:/\.(jpe?g|png|gif|tiff|webp)$/i,effect:/texture|gradient/i};D.document&&(kt=document.createElement("a"));function U(e,t){if(this.renderer={},this._renderer.type="texture",this._renderer.flagOffset=U.FlagOffset.bind(this),this._renderer.flagScale=U.FlagScale.bind(this),this.id=ee.Identifier+ee.uniqueId(),this.classList=[],this.loaded=!1,this.repeat="no-repeat",this.offset=new w,typeof t=="function"){var i=function(){this.unbind(m.Types.load,i),typeof t=="function"&&t()}.bind(this);this.bind(m.Types.load,i)}if(typeof e=="string")this.src=e;else if(typeof e=="object"){var r=Object.prototype.toString.call(e);(r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]"||r==="[object HTMLVideoElement]"||r==="[object Image]")&&(this.image=e)}this._update()}f.extend(U,{Properties:["id","src","loaded","repeat"],RegularExpressions:xi,ImageRegistry:new je,getAbsoluteURL:function(e){return kt?(kt.href=e,kt.href):e},loadHeadlessBuffer:function(e,t){e.image.onload=t,e.image.src=e.src},getTag:function(e){return e&&e.nodeName&&e.nodeName.toLowerCase()||"img"},getImage:function(e){var t=U.getAbsoluteURL(e);if(U.ImageRegistry.contains(t))return U.ImageRegistry.get(t);var i;return ge.Image?(i=new ge.Image,Ue.Utils.shim(i,"img")):D.document?xi.video.test(t)?i=document.createElement("video"):i=document.createElement("img"):console.warn("Two.js: no prototypical image defined for Two.Texture"),i.crossOrigin="anonymous",i},Register:{canvas:function(e,t){e._src="#"+e.id,U.ImageRegistry.add(e.src,e.image),typeof t=="function"&&t()},img:function(e,t){var i=e.image,r=function(a){!ge.isHeadless&&i.removeEventListener&&typeof i.removeEventListener=="function"&&(i.removeEventListener("load",r,!1),i.removeEventListener("error",s,!1)),typeof t=="function"&&t()},s=function(a){throw!ge.isHeadless&&typeof i.removeEventListener=="function"&&(i.removeEventListener("load",r,!1),i.removeEventListener("error",s,!1)),new le("unable to load "+e.src)};typeof i.width=="number"&&i.width>0&&typeof i.height=="number"&&i.height>0?r():!ge.isHeadless&&typeof i.addEventListener=="function"&&(i.addEventListener("load",r,!1),i.addEventListener("error",s,!1)),e._src=U.getAbsoluteURL(e._src),!(!ge.isHeadless&&i&&i.getAttribute("two-src"))&&(ge.isHeadless||i.setAttribute("two-src",e.src),U.ImageRegistry.add(e.src,i),ge.isHeadless?U.loadHeadlessBuffer(e,r):e.image.src=e.src)},video:function(e,t){if(ge.isHeadless)throw new le("video textures are not implemented in headless environments.");var i=function(s){e.image.removeEventListener("canplaythrough",i,!1),e.image.removeEventListener("error",r,!1),e.image.width=e.image.videoWidth,e.image.height=e.image.videoHeight,typeof t=="function"&&t()},r=function(s){throw e.image.removeEventListener("canplaythrough",i,!1),e.image.removeEventListener("error",r,!1),new le("unable to load "+e.src)};e._src=U.getAbsoluteURL(e._src),e.image.getAttribute("two-src")||(e.image.setAttribute("two-src",e.src),U.ImageRegistry.add(e.src,e.image)),e.image.readyState>=4?i():(e.image.addEventListener("canplaythrough",i,!1),e.image.addEventListener("error",r,!1),e.image.src=e.src,e.image.load())}},load:function(e,t){var i=e.image,r=U.getTag(i);e._flagImage&&(/canvas/i.test(r)?U.Register.canvas(e,t):(e._src=!ge.isHeadless&&i.getAttribute("two-src")||i.src,U.Register[r](e,t))),e._flagSrc&&(i||(i=U.getImage(e.src),e.image=i),r=U.getTag(i),U.Register[r](e,t))},FlagOffset:function(){this._flagOffset=!0},FlagScale:function(){this._flagScale=!0},MakeObservable:function(e){f.each(U.Properties,N,e),Object.defineProperty(e,"image",{enumerable:!0,get:function(){return this._image},set:function(t){var i=U.getTag(t),r;switch(i){case"canvas":r="#"+t.id;break;default:r=t.src}U.ImageRegistry.contains(r)?this._image=U.ImageRegistry.get(t.src):this._image=t,this._flagImage=!0}}),Object.defineProperty(e,"offset",{enumerable:!0,get:function(){return this._offset},set:function(t){this._offset&&this._offset.unbind(m.Types.change,this._renderer.flagOffset),this._offset=t,this._offset.bind(m.Types.change,this._renderer.flagOffset),this._flagOffset=!0}}),Object.defineProperty(e,"scale",{enumerable:!0,get:function(){return this._scale},set:function(t){this._scale instanceof w&&this._scale.unbind(m.Types.change,this._renderer.flagScale),this._scale=t,this._scale instanceof w&&this._scale.bind(m.Types.change,this._renderer.flagScale),this._flagScale=!0}}),Object.defineProperty(e,"renderer",{enumerable:!1,get:function(){return this._renderer},set:function(t){this._renderer=t}})}});f.extend(U.prototype,m,Y.prototype,{constructor:U,_flagId:!1,_flagSrc:!1,_flagImage:!1,_flagVideo:!1,_flagLoaded:!1,_flagRepeat:!1,_flagOffset:!1,_flagScale:!1,_id:"",_src:"",_image:null,_loaded:!1,_repeat:"no-repeat",_scale:1,_offset:null,clone:function(){var e=new U(this.src);return e.repeat=this.repeat,e.offset.copy(this.origin),e.scale=this.scale,e},toObject:function(){return{src:this.src,repeat:this.repeat,origin:this.origin.toObject(),scale:typeof this.scale=="number"?this.scale:this.scale.toObject()}},_update:function(){return(this._flagSrc||this._flagImage)&&(this.trigger(m.Types.change),(this._flagSrc||this._flagImage)&&(this.loaded=!1,U.load(this,function(){this.loaded=!0,this.trigger(m.Types.change).trigger(m.Types.load)}.bind(this)))),this._image&&this._image.readyState>=4&&(this._flagVideo=!0),this},flagReset:function(){return this._flagSrc=this._flagImage=this._flagLoaded=this._flagVideo=this._flagScale=this._flagOffset=!1,this}});U.MakeObservable(U.prototype);var V=U;var He=Math.min,We=Math.max,sr=Math.ceil,nr=Math.floor;function he(e,t,i,r){Y.call(this),this._renderer.type="path",this._renderer.flagVertices=he.FlagVertices.bind(this),this._renderer.bindVertices=he.BindVertices.bind(this),this._renderer.unbindVertices=he.UnbindVertices.bind(this),this._renderer.flagFill=he.FlagFill.bind(this),this._renderer.flagStroke=he.FlagStroke.bind(this),this._renderer.vertices=[],this._renderer.collection=[],this._closed=!!t,this._curved=!!i,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.className="",this.visible=!0,this.cap="butt",this.join="miter",this.miter=4,this.vertices=e,this.automatic=!r,this.dashes=[],this.dashes.offset=0}f.extend(he,{Properties:["fill","stroke","linewidth","opacity","visible","cap","join","miter","closed","curved","automatic","beginning","ending"],Utils:{getCurveLength:Jt},FlagVertices:function(){this._flagVertices=!0,this._flagLength=!0,this.parent&&(this.parent._flagLength=!0)},BindVertices:function(e){for(var t=e.length;t--;)e[t].bind(m.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()},UnbindVertices:function(e){for(var t=e.length;t--;)e[t].unbind(m.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()},FlagFill:function(){this._flagFill=!0},FlagStroke:function(){this._flagStroke=!0},MakeObservable:function(e){Y.MakeObservable(e),f.each(he.Properties.slice(2,8),N,e),Object.defineProperty(e,"fill",{enumerable:!0,get:function(){return this._fill},set:function(t){(this._fill instanceof B||this._fill instanceof H||this._fill instanceof W||this._fill instanceof V)&&this._fill.unbind(m.Types.change,this._renderer.flagFill),this._fill=t,this._flagFill=!0,(this._fill instanceof B||this._fill instanceof H||this._fill instanceof W||this._fill instanceof V)&&this._fill.bind(m.Types.change,this._renderer.flagFill)}}),Object.defineProperty(e,"stroke",{enumerable:!0,get:function(){return this._stroke},set:function(t){(this._stroke instanceof B||this._stroke instanceof H||this._stroke instanceof W||this._stroke instanceof V)&&this._stroke.unbind(m.Types.change,this._renderer.flagStroke),this._stroke=t,this._flagStroke=!0,(this._stroke instanceof B||this._stroke instanceof H||this._stroke instanceof W||this._stroke instanceof V)&&this._stroke.bind(m.Types.change,this._renderer.flagStroke)}}),Object.defineProperty(e,"length",{get:function(){return this._flagLength&&this._updateLength(),this._length}}),Object.defineProperty(e,"closed",{enumerable:!0,get:function(){return this._closed},set:function(t){this._closed=!!t,this._flagVertices=!0}}),Object.defineProperty(e,"curved",{enumerable:!0,get:function(){return this._curved},set:function(t){this._curved=!!t,this._flagVertices=!0}}),Object.defineProperty(e,"automatic",{enumerable:!0,get:function(){return this._automatic},set:function(t){if(t!==this._automatic){this._automatic=!!t;var i=this._automatic?"ignore":"listen";f.each(this.vertices,function(r){r[i]()})}}}),Object.defineProperty(e,"beginning",{enumerable:!0,get:function(){return this._beginning},set:function(t){this._beginning=t,this._flagVertices=!0}}),Object.defineProperty(e,"ending",{enumerable:!0,get:function(){return this._ending},set:function(t){this._ending=t,this._flagVertices=!0}}),Object.defineProperty(e,"vertices",{enumerable:!0,get:function(){return this._collection},set:function(t){var i=this._renderer.bindVertices,r=this._renderer.unbindVertices;this._collection&&this._collection.unbind(m.Types.insert,i).unbind(m.Types.remove,r),t instanceof fe?this._collection=t:this._collection=new fe(t||[]),this._collection.bind(m.Types.insert,i).bind(m.Types.remove,r),i(this._collection)}}),Object.defineProperty(e,"mask",{enumerable:!0,get:function(){return this._mask},set:function(t){this._mask&&(this._mask.clip=!1),this._mask=t,this._flagMask=!0,t&&!t.clip&&(t.clip=!0)}}),Object.defineProperty(e,"clip",{enumerable:!0,get:function(){return this._clip},set:function(t){this._clip=t,this._flagClip=!0}}),Object.defineProperty(e,"dashes",{enumerable:!0,get:function(){return this._dashes},set:function(t){typeof t.offset!="number"&&(t.offset=this.dashes&&this._dashes.offset||0),this._dashes=t}})}});f.extend(he.prototype,Y.prototype,{constructor:he,_flagVertices:!0,_flagLength:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_flagMask:!1,_flagClip:!1,_length:0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,_mask:null,_clip:!1,_dashes:null,clone:function(e){for(var t=new he,i=0;i<this.vertices.length;i++)t.vertices.push(this.vertices[i].clone());for(var r=0;r<he.Properties.length;r++){var s=he.Properties[r];t[s]=this[s]}return t.className=this.className,t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()},toObject:function(){var e={vertices:this.vertices.map(function(t){return t.toObject()})};return f.each(he.Properties,function(t){typeof this[t]!="undefined"&&(this[t].toObject?e[t]=this[t].toObject():e[t]=this[t])},this),e.className=this.className,e.translation=this.translation.toObject(),e.rotation=this.rotation,e.scale=this.scale instanceof w?this.scale.toObject():this.scale,e.skewX=this.skewX,e.skewY=this.skewY,this.matrix.manual&&(e.matrix=this.matrix.toObject()),e},noFill:function(){return this.fill="transparent",this},noStroke:function(){return this.stroke=void 0,this},corner:function(){for(var e=this.getBoundingClientRect(!0),t=e.width/2,i=e.height/2,r=e.left+e.width/2,s=e.top+e.height/2,a=0;a<this.vertices.length;a++){var n=this.vertices[a];n.x-=r,n.y-=s,n.x+=t,n.y+=i}return this.mask&&(this.mask.translation.x-=r,this.mask.translation.x+=t,this.mask.translation.y-=s,this.mask.translation.y+=i),this},center:function(){for(var e=this.getBoundingClientRect(!0),t=e.left+e.width/2-this.translation.x,i=e.top+e.height/2-this.translation.y,r=0;r<this.vertices.length;r++){var s=this.vertices[r];s.x-=t,s.y-=i}return this.mask&&(this.mask.translation.x-=t,this.mask.translation.y-=i),this},remove:function(){return this.parent?(this.parent.remove(this),this):this},getBoundingClientRect:function(e){var t,i,r,s,a,n,o,l,h,_,d,c,u,g,y=1/0,x=-1/0,p=1/0,v=-1/0;if(this._update(!0),t=e?this._matrix:Se(this),i=(this.linewidth||0)/2,r=this._renderer.vertices.length,r<=0)return{width:0,height:0};for(s=0;s<r;s++)if(n=this._renderer.vertices[s],a=this._renderer.vertices[(s+r-1)%r],a.controls&&n.controls){o=a.controls.right.x,l=a.controls.right.y,a.relative&&(o+=a.x,l+=a.y),h=n.controls.left.x,_=n.controls.left.y,n.relative&&(h+=n.x,_+=n.y);var k=Ut(a.x,a.y,o,l,h,_,n.x,n.y);p=He(k.min.y-i,p),y=He(k.min.x-i,y),x=We(k.max.x+i,x),v=We(k.max.y+i,v)}else s<=1&&(p=He(a.y-i,p),y=He(a.x-i,y),x=We(a.x+i,x),v=We(a.y+i,v)),p=He(n.y-i,p),y=He(n.x-i,y),x=We(n.x+i,x),v=We(n.y+i,v);return d=t.multiply(y,p,1),c=t.multiply(y,v,1),u=t.multiply(x,p,1),g=t.multiply(x,v,1),p=He(d.y,c.y,u.y,g.y),y=He(d.x,c.x,u.x,g.x),x=We(d.x,c.x,u.x,g.x),v=We(d.y,c.y,u.y,g.y),{top:p,left:y,right:x,bottom:v,width:x-y,height:v-p}},getPointAt:function(e,t){for(var i,r,s,a,n,o,l,h,_,d,c,u,g,y,x,p=this.length*Math.min(Math.max(e,0),1),v=this.vertices.length,k=v-1,T=null,S=null,R=0,C=this._lengths.length,E=0;R<C;R++){if(E+this._lengths[R]>=p){this._closed?(i=re(R,v),r=re(R-1,v),R===0&&(i=r,r=R)):(i=R,r=Math.min(Math.max(R-1,0),k)),T=this.vertices[i],S=this.vertices[r],p-=E,this._lengths[R]!==0?e=p/this._lengths[R]:e=0;break}E+=this._lengths[R]}if(T===null||S===null)return null;if(T){if(!S)return T}else return S;x=S.controls&&S.controls.right,y=T.controls&&T.controls.left,n=S.x,d=S.y,o=(x||S).x,c=(x||S).y,l=(y||T).x,u=(y||T).y,h=T.x,g=T.y,x&&S.relative&&(o+=S.x,c+=S.y),y&&T.relative&&(l+=T.x,u+=T.y),a=$e(e,n,o,l,h),_=$e(e,d,c,u,g);var O=ae(n,o,e),F=ae(d,c,e),I=ae(o,l,e),j=ae(c,u,e),X=ae(l,h,e),z=ae(u,g,e),ne=ae(O,I,e),ke=ae(F,j,e),we=ae(I,X,e),Q=ae(j,z,e);return f.isObject(t)?(t.x=a,t.y=_,f.isObject(t.controls)||M.AppendCurveProperties(t),t.controls.left.x=ne,t.controls.left.y=ke,t.controls.right.x=we,t.controls.right.y=Q,(typeof t.relative!="boolean"||t.relative)&&(t.controls.left.x-=a,t.controls.left.y-=_,t.controls.right.x-=a,t.controls.right.y-=_),t.t=e,t):(s=new M(a,_,ne-a,ke-_,we-a,Q-_,this._curved?b.curve:b.line),s.t=e,s)},plot:function(){if(this.curved)return jt(this._collection,this.closed),this;for(var e=0;e<this._collection.length;e++)this._collection[e].command=e===0?b.move:b.line;return this},subdivide:function(e){this._update();var t=this.vertices.length-1,i=this.vertices[t],r=this._closed||this.vertices[t]._command===b.close,s=[];return f.each(this.vertices,function(a,n){if(n<=0&&!r){i=a;return}if(a.command===b.move){s.push(new M(i.x,i.y)),n>0&&(s[s.length-1].command=b.line),i=a;return}var o=ki(a,i,e);s=s.concat(o),f.each(o,function(l,h){h<=0&&i.command===b.move?l.command=b.move:l.command=b.line}),n>=t&&(this._closed&&this._automatic?(i=a,o=ki(a,i,e),s=s.concat(o),f.each(o,function(l,h){h<=0&&i.command===b.move?l.command=b.move:l.command=b.line})):r&&s.push(new M(a.x,a.y)),s[s.length-1].command=r?b.close:b.line),i=a},this),this._automatic=!1,this._curved=!1,this.vertices=s,this},_updateLength:function(e,t){t||this._update();var i=this.vertices.length,r=i-1,s=this.vertices[r],a=!1,n=0;return typeof this._lengths=="undefined"&&(this._lengths=[]),f.each(this.vertices,function(o,l){if(l<=0&&!a||o.command===b.move){s=o,this._lengths[l]=0;return}this._lengths[l]=Jt(o,s,e),n+=this._lengths[l],l>=r&&a&&(s=this.vertices[(l+1)%i],this._lengths[l+1]=Jt(o,s,e),n+=this._lengths[l+1]),s=o},this),this._length=n,this._flagLength=!1,this},_update:function(){if(this._flagVertices){this._automatic&&this.plot(),this._flagLength&&this._updateLength(void 0,!0);var e=this._collection.length,t=this._closed,i=Math.min(this._beginning,this._ending),r=Math.max(this._beginning,this._ending),s=it(this,i*this._length),a=it(this,r*this._length),n=sr(s),o=nr(a),l,h,_,d,c;this._renderer.vertices.length=0;for(var u=0;u<e;u++)this._renderer.collection.length<=u&&this._renderer.collection.push(new M),u>o&&!h?(c=this._renderer.collection[u],c.copy(this._collection[u]),this.getPointAt(r,c),c.command=this._renderer.collection[u].command,this._renderer.vertices.push(c),h=c,_=this._collection[u-1],_&&_.controls&&(c.controls.right.clear(),this._renderer.collection[u-1].controls.right.clear().lerp(_.controls.right,c.t))):u>=n&&u<=o&&(c=this._renderer.collection[u].copy(this._collection[u]),this._renderer.vertices.push(c),u===o&&bi(this,r)?(h=c,!t&&h.controls&&h.controls.right.clear()):u===n&&bi(this,i)&&(l=c,l.command=b.move,!t&&l.controls&&l.controls.left.clear()));n>0&&!l&&(u=n-1,c=this._renderer.collection[u],c.copy(this._collection[u]),this.getPointAt(i,c),c.command=b.move,this._renderer.vertices.unshift(c),d=this._collection[u+1],d&&d.controls&&(c.controls.left.clear(),this._renderer.collection[u+1].controls.left.copy(d.controls.left).lerp(w.zero,c.t)))}return Y.prototype._update.apply(this,arguments),this},flagReset:function(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=this._flagClip=!1,Y.prototype.flagReset.call(this),this}});he.MakeObservable(he.prototype);function bi(e,t){if(t===0||t===1)return!0;for(var i=e._length,r=i*t,s=0,a=0;a<e._lengths.length;a++){var n=e._lengths[a];if(s>=r)return r-s>=0;s+=n}return!1}function it(e,t){var i=e._length;if(t<=0)return 0;if(t>=i)return e._lengths.length-1;for(var r=0,s=0;r<e._lengths.length;r++){if(s+e._lengths[r]>=t)return t-=s,Math.max(r-1,0)+t/e._lengths[r];s+=e._lengths[r]}return-1}function Jt(e,t,i){var r,s,a,n,o,l,h,_,d=t.controls&&t.controls.right,c=e.controls&&e.controls.left;return r=t.x,o=t.y,s=(d||t).x,l=(d||t).y,a=(c||e).x,h=(c||e).y,n=e.x,_=e.y,d&&t._relative&&(s+=t.x,l+=t.y),c&&e._relative&&(a+=e.x,h+=e.y),Gt(r,o,s,l,a,h,n,_,i)}function ki(e,t,i){var r,s,a,n,o,l,h,_,d=t.controls&&t.controls.right,c=e.controls&&e.controls.left;return r=t.x,o=t.y,s=(d||t).x,l=(d||t).y,a=(c||e).x,h=(c||e).y,n=e.x,_=e.y,d&&t._relative&&(s+=t.x,l+=t.y),c&&e._relative&&(a+=e.x,h+=e.y),et(r,o,s,l,a,h,n,_,i)}var A=he;function Xe(e,t,i,r){A.call(this,[new M,new M,new M,new M],!0,!1,!0),this.width=i,this.height=r,this.origin=new w,this.translation.set(e,t),this._update()}f.extend(Xe,{Properties:["width","height"],MakeObservable:function(e){A.MakeObservable(e),f.each(Xe.Properties,N,e),Object.defineProperty(e,"origin",{enumerable:!0,get:function(){return this._origin},set:function(t){this._origin&&this._origin.unbind(m.Types.change,this._renderer.flagVertices),this._origin=t,this._origin.bind(m.Types.change,this._renderer.flagVertices),this._renderer.flagVertices()}})}});f.extend(Xe.prototype,A.prototype,{constructor:Xe,_flagWidth:0,_flagHeight:0,_width:0,_height:0,_origin:null,_update:function(){if(this._flagVertices||this._flagWidth||this._flagHeight){var e=this._width/2,t=this._height/2;!this._closed&&this.vertices.length===4&&this.vertices.push(new M),this.vertices[0].set(-e,-t).sub(this._origin).command=b.move,this.vertices[1].set(e,-t).sub(this._origin).command=b.line,this.vertices[2].set(e,t).sub(this._origin).command=b.line,this.vertices[3].set(-e,t).sub(this._origin).command=b.line,this.vertices[4]&&(this.vertices[4].set(-e,-t).sub(this._origin).command=b.line)}return A.prototype._update.call(this),this},flagReset:function(){return this._flagWidth=this._flagHeight=!1,A.prototype.flagReset.call(this),this},clone:function(e){var t=new Xe(0,0,this.width,this.height);return t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),f.each(A.Properties,function(i){t[i]=this[i]},this),e&&e.add(t),t},toObject:function(){var e=A.prototype.toObject.call(this);return e.width=this.width,e.height=this.height,e.origin=this.origin.toObject(),e}});Xe.MakeObservable(Xe.prototype);var se=Xe;function Ye(e,t,i,r,s,a){A.call(this,[new M,new M,new M,new M],!0),this.noStroke(),this.noFill(),e instanceof V?this.texture=e:typeof e=="string"&&(this.texture=new V(e)),this.origin=new w,this._update(),this.translation.set(t||0,i||0),typeof r=="number"&&(this.columns=r),typeof s=="number"&&(this.rows=s),typeof a=="number"&&(this.frameRate=a),this.index=0}f.extend(Ye,{Properties:["texture","columns","rows","frameRate","index"],MakeObservable:function(e){se.MakeObservable(e),f.each(Ye.Properties,N,e)}});f.extend(Ye.prototype,se.prototype,{constructor:Ye,_flagTexture:!1,_flagColumns:!1,_flagRows:!1,_flagFrameRate:!1,flagIndex:!1,_amount:1,_duration:0,_startTime:0,_playing:!1,_firstFrame:0,_lastFrame:0,_loop:!0,_texture:null,_columns:1,_rows:1,_frameRate:0,_index:0,_origin:null,play:function(e,t,i){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=f.performance.now(),typeof e=="number"&&(this._firstFrame=e),typeof t=="number"&&(this._lastFrame=t),typeof i=="function"?this._onLastFrame=i:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this},pause:function(){return this._playing=!1,this},stop:function(){return this._playing=!1,this._index=0,this},clone:function(e){var t=new Ye(this.texture,this.translation.x,this.translation.y,this.columns,this.rows,this.frameRate);return this.playing&&(t.play(this._firstFrame,this._lastFrame),t._loop=this._loop),e&&e.add(t),t},toObject:function(){var e=se.prototype.toObject.call(this);return e.texture=this.texture.toObject(),e.columns=this.columns,e.rows=this.rows,e.frameRate=this.frameRate,e.index=this.index,e._firstFrame=this._firstFrame,e._lastFrame=this._lastFrame,e._loop=this._loop,e},_update:function(){var e=this._texture,t=this._columns,i=this._rows,r,s,a,n,o,l,h,_,d;if((this._flagColumns||this._flagRows)&&(this._amount=this._columns*this._rows),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._flagTexture&&(this.fill=this._texture),this._texture.loaded){h=e.image.width,_=e.image.height,r=h/t,s=_/i,n=this._amount,this.width!==r&&(this.width=r),this.height!==s&&(this.height=s),this._playing&&this._frameRate>0&&(f.isNaN(this._lastFrame)&&(this._lastFrame=n-1),a=f.performance.now()-this._startTime,d=this._lastFrame+1,o=1e3*(d-this._firstFrame)/this._frameRate,this._loop?a=a%o:a=Math.min(a,o),l=ae(this._firstFrame,d,a/o),l=Math.floor(l),l!==this._index&&(this._index=l,l>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()));var c=this._index%t,u=Math.floor(this._index/t),g=-r*c+(h-r)/2,y=-s*u+(_-s)/2;g!==e.offset.x&&(e.offset.x=g),y!==e.offset.y&&(e.offset.y=y)}return se.prototype._update.call(this),this},flagReset:function(){return this._flagTexture=this._flagColumns=this._flagRows=this._flagFrameRate=!1,se.prototype.flagReset.call(this),this}});Ye.MakeObservable(Ye.prototype);var rt=Ye;var $t=Math.cos,Zt=Math.sin;function Ie(e,t,i,r){for(var s=r?Math.max(r,2):4,a=[],n=0;n<s;n++)a.push(new M(0,0,0,0,0,0));A.call(this,a,!0,!0,!0),typeof i=="number"&&(this.radius=i),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}f.extend(Ie,{Properties:["radius"],MakeObservable:function(e){A.MakeObservable(e),f.each(Ie.Properties,N,e)}});f.extend(Ie.prototype,A.prototype,{constructor:Ie,_flagRadius:!1,_radius:0,_update:function(){if(this._flagVertices||this._flagRadius){var e=this.vertices.length;!this._closed&&e>2&&(e-=1);for(var t=4/3*Math.tan(Math.PI/(e*2)),i=this._radius,r=i*t,s=0;s<this.vertices.length;s++){var a=s/e,n=a*K,o=i*$t(n),l=i*Zt(n),h=r*$t(n-J),_=r*Zt(n-J),d=r*$t(n+J),c=r*Zt(n+J),u=this.vertices[s];u.command=s===0?b.move:b.curve,u.set(o,l),u.controls.left.set(h,_),u.controls.right.set(d,c)}}return A.prototype._update.call(this),this},flagReset:function(){return this._flagRadius=!1,A.prototype.flagReset.call(this),this},clone:function(e){var t=new Ie(0,0,this.radius,this.vertices.length);return t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),f.each(A.Properties,function(i){t[i]=this[i]},this),e&&e.add(t),t},toObject:function(){var e=A.prototype.toObject.call(this);return f.each(Ie.Properties,function(t){e[t]=this[t]},this),e}});Ie.MakeObservable(Ie.prototype);var st=Ie;var Qt=Math.cos,ei=Math.sin;function Be(e,t,i,r,s){typeof r!="number"&&typeof i=="number"&&(r=i);for(var a=s?Math.max(s,2):4,n=[],o=0;o<a;o++)n.push(new M);A.call(this,n,!0,!0,!0),typeof i=="number"&&(this.width=i*2),typeof r=="number"&&(this.height=r*2),this._update(),this.translation.set(e,t)}f.extend(Be,{Properties:["width","height"],MakeObservable:function(e){A.MakeObservable(e),f.each(Be.Properties,N,e)}});f.extend(Be.prototype,A.prototype,{_flagWidth:!1,_flagHeight:!1,_width:0,_height:0,constructor:Be,_update:function(){if(this._flagVertices||this._flagWidth||this._flagHeight){var e=this.vertices.length;!this._closed&&e>2&&(e-=1);for(var t=4/3*Math.tan(Math.PI/(this.vertices.length*2)),i=this._width/2,r=this._height/2,s=0;s<this.vertices.length;s++){var a=s/e,n=a*K,o=i*Qt(n),l=r*ei(n),h=i*t*Qt(n-J),_=r*t*ei(n-J),d=i*t*Qt(n+J),c=r*t*ei(n+J),u=this.vertices[s];u.command=s===0?b.move:b.curve,u.set(o,l),u.controls.left.set(h,_),u.controls.right.set(d,c)}}return A.prototype._update.call(this),this},flagReset:function(){return this._flagWidth=this._flagHeight=!1,A.prototype.flagReset.call(this),this},clone:function(e){var t=this.width/2,i=this.height/2,r=this.vertices.length,s=new Be(0,0,t,i,r);return s.translation.copy(this.translation),s.rotation=this.rotation,s.scale=this.scale,s.skewX=this.skewX,s.skewY=this.skewY,this.matrix.manual&&s.matrix.copy(this.matrix),f.each(A.Properties,function(a){s[a]=this[a]},this),e&&e.add(s),s},toObject:function(){var e=A.prototype.toObject.call(this);return f.each(Be.Properties,function(t){e[t]=this[t]},this),e}});Be.MakeObservable(Be.prototype);var nt=Be;function wt(e,t,i,r){A.call(this,[new M(e,t),new M(i,r)]),this.vertices[0].command=b.move,this.vertices[1].command=b.line,this.automatic=!1}f.extend(wt.prototype,A.prototype,{constructor:wt});A.MakeObservable(wt.prototype);var at=wt;function Pe(e,t,i,r,s){typeof s=="undefined"&&typeof i=="number"&&typeof r=="number"&&(s=Math.floor(Math.min(i,r)/12));for(var a=10,n=[],o=0;o<a;o++)n.push(new M(0,0,0,0,0,0,o===0?b.move:b.curve));A.call(this,n),this.closed=!0,this.automatic=!1,this._renderer.flagRadius=Pe.FlagRadius.bind(this),typeof i=="number"&&(this.width=i),typeof r=="number"&&(this.height=r),typeof s=="number"&&(this.radius=s),this._update(),this.translation.set(e,t)}f.extend(Pe,{Properties:["width","height"],FlagRadius:function(){this._flagRadius=!0},MakeObservable:function(e){A.MakeObservable(e),f.each(Pe.Properties,N,e),Object.defineProperty(e,"radius",{enumerable:!0,get:function(){return this._radius},set:function(t){this._radius instanceof w&&this._radius.unbind(m.Types.change,this._renderer.flagRadius),this._radius=t,this._radius instanceof w&&this._radius.bind(m.Types.change,this._renderer.flagRadius),this._flagRadius=!0}})}});f.extend(Pe.prototype,A.prototype,{constructor:Pe,_flagWidth:!1,_flagHeight:!1,_flagRadius:!1,_width:0,_height:0,_radius:12,_update:function(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagRadius){var e=this._width,t=this._height,i,r;this._radius instanceof w?(i=this._radius.x,r=this._radius.y):(i=this._radius,r=this._radius);var s,a=e/2,n=t/2;s=this.vertices[0],s.x=-(a-i),s.y=-n,s=this.vertices[1],s.x=a-i,s.y=-n,s.controls.left.clear(),s.controls.right.x=i,s.controls.right.y=0,s=this.vertices[2],s.x=a,s.y=-(n-r),s.controls.right.clear(),s.controls.left.clear(),s=this.vertices[3],s.x=a,s.y=n-r,s.controls.left.clear(),s.controls.right.x=0,s.controls.right.y=r,s=this.vertices[4],s.x=a-i,s.y=n,s.controls.right.clear(),s.controls.left.clear(),s=this.vertices[5],s.x=-(a-i),s.y=n,s.controls.left.clear(),s.controls.right.x=-i,s.controls.right.y=0,s=this.vertices[6],s.x=-a,s.y=n-r,s.controls.left.clear(),s.controls.right.clear(),s=this.vertices[7],s.x=-a,s.y=-(n-r),s.controls.left.clear(),s.controls.right.x=0,s.controls.right.y=-r,s=this.vertices[8],s.x=-(a-i),s.y=-n,s.controls.left.clear(),s.controls.right.clear(),s=this.vertices[9],s.copy(this.vertices[8])}return A.prototype._update.call(this),this},flagReset:function(){return this._flagWidth=this._flagHeight=this._flagRadius=!1,A.prototype.flagReset.call(this),this},clone:function(e){var t=this.width,i=this.height,r=this.radius,s=new Pe(0,0,t,i,r);return s.translation.copy(this.translation),s.rotation=this.rotation,s.scale=this.scale,s.skewX=this.skewX,s.skewY=this.skewY,this.matrix.manual&&s.matrix.copy(this.matrix),f.each(A.Properties,function(a){s[a]=this[a]},this),e&&e.add(s),s},toObject:function(){var e=A.prototype.toObject.call(this);return f.each(Pe.Properties,function(t){e[t]=this[t]},this),e.radius=typeof this.radius=="number"?this.radius:this.radius.toObject(),e}});Pe.MakeObservable(Pe.prototype);var ot=Pe;var wi=Math.min,Si=Math.max;function de(e,t,i,r){if(Y.call(this),this._renderer.type="text",this._renderer.flagFill=de.FlagFill.bind(this),this._renderer.flagStroke=de.FlagStroke.bind(this),this.value=e,typeof t=="number"&&(this.translation.x=t),typeof i=="number"&&(this.translation.y=i),this.dashes=[],this.dashes.offset=0,!f.isObject(r))return this;f.each(de.Properties,function(s){s in r&&(this[s]=r[s])},this)}f.extend(de,{Ratio:.6,Properties:["value","family","size","leading","alignment","linewidth","style","weight","decoration","baseline","opacity","visible","className","fill","stroke"],FlagFill:function(){this._flagFill=!0},FlagStroke:function(){this._flagStroke=!0},MakeObservable:function(e){Y.MakeObservable(e),f.each(de.Properties.slice(0,12),N,e),Object.defineProperty(e,"fill",{enumerable:!0,get:function(){return this._fill},set:function(t){(this._fill instanceof B||this._fill instanceof H||this._fill instanceof W||this._fill instanceof V)&&this._fill.unbind(m.Types.change,this._renderer.flagFill),this._fill=t,this._flagFill=!0,(this._fill instanceof B||this._fill instanceof H||this._fill instanceof W||this._fill instanceof V)&&this._fill.bind(m.Types.change,this._renderer.flagFill)}}),Object.defineProperty(e,"stroke",{enumerable:!0,get:function(){return this._stroke},set:function(t){(this._stroke instanceof B||this._stroke instanceof H||this._stroke instanceof W||this._stroke instanceof V)&&this._stroke.unbind(m.Types.change,this._renderer.flagStroke),this._stroke=t,this._flagStroke=!0,(this._stroke instanceof B||this._stroke instanceof H||this._stroke instanceof W||this._stroke instanceof V)&&this._stroke.bind(m.Types.change,this._renderer.flagStroke)}}),Object.defineProperty(e,"mask",{enumerable:!0,get:function(){return this._mask},set:function(t){this._mask&&(this._mask.clip=!1),this._mask=t,this._flagMask=!0,t&&!t.clip&&(t.clip=!0)}}),Object.defineProperty(e,"clip",{enumerable:!0,get:function(){return this._clip},set:function(t){this._clip=t,this._flagClip=!0}}),Object.defineProperty(e,"dashes",{enumerable:!0,get:function(){return this._dashes},set:function(t){typeof t.offset!="number"&&(t.offset=this.dashes&&this._dashes.offset||0),this._dashes=t}})}});f.extend(de.prototype,Y.prototype,{constructor:de,_flagValue:!0,_flagFamily:!0,_flagSize:!0,_flagLeading:!0,_flagAlignment:!0,_flagBaseline:!0,_flagStyle:!0,_flagWeight:!0,_flagDecoration:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagClassName:!0,_flagVisible:!0,_flagMask:!1,_flagClip:!1,_value:"",_family:"sans-serif",_size:13,_leading:17,_alignment:"center",_baseline:"middle",_style:"normal",_weight:500,_decoration:"none",_fill:"#000",_stroke:"transparent",_linewidth:1,_opacity:1,_className:"",_visible:!0,_mask:null,_clip:!1,_dashes:null,remove:function(){return this.parent?(this.parent.remove(this),this):this},clone:function(e){var t=new de(this.value);return t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,f.each(de.Properties,function(i){t[i]=this[i]},this),this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()},toObject:function(){var e={translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};return this.matrix.manual&&(e.matrix=this.matrix.toObject()),f.each(de.Properties,function(t){e[t]=this[t]},this),e},noFill:function(){return this.fill="transparent",this},noStroke:function(){return this.stroke=void 0,this.linewidth=void 0,this},getBoundingClientRect:function(e){var t,i,r,s,a,n,o,l,h;this._update(!0),t=e?this._matrix:Se(this);var _=this.leading,d=this.value.length*this.size*de.Ratio,c=(this._linewidth||0)/2;switch(this.alignment){case"left":n=-c,o=d+c;break;case"right":n=-(d+c),o=c;break;default:n=-(d/2+c),o=d/2+c}switch(this.baseline){case"top":l=-c,h=_+c;break;case"bottom":l=-(_+c),h=c;break;default:l=-(_/2+c),h=_/2+c}return i=t.multiply(n,l,1),r=t.multiply(n,h,1),s=t.multiply(o,l,1),a=t.multiply(o,h,1),l=wi(i.y,r.y,s.y,a.y),n=wi(i.x,r.x,s.x,a.x),o=Si(i.x,r.x,s.x,a.x),h=Si(i.y,r.y,s.y,a.y),{top:l,left:n,right:o,bottom:h,width:o-n,height:h-l}},flagReset:function(){return this._flagValue=this._flagFamily=this._flagSize=this._flagLeading=this._flagAlignment=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagClip=this._flagDecoration=this._flagClassName=this._flagBaseline=this._flagWeight=this._flagStyle=!1,Y.prototype.flagReset.call(this),this}});de.MakeObservable(de.prototype);var Me=de;var Ee={path:/[+-]?(?:\d*\.\d+|\d+)(?:[eE][+-]\d+)?/g,cssBackgroundImage:/url\(['"]?#([\w\d-_]*)['"]?\)/i,unitSuffix:/[a-zA-Z%]*/i},ar={start:"left",middle:"center",end:"right"},or=function(e){return ar[e]},lr=function(e){var t=e.getAttribute("dominant-baseline"),i=e.getAttribute("alignment-baseline");return t||i},lt=function(e){return e.replace(/svg:/ig,"").toLowerCase()},Ai=function(e,t){if(t.x+=e.translateX,t.y+=e.translateY,t.x*=e.scaleX,t.y*=e.scaleY,e.rotation!==0){var i=t.length();t.x=i*Math.cos(e.rotation),t.y=i*Math.sin(e.rotation)}},hr=function(e,t){var i,r,s,a;t||(t={}),i=e.split(";");for(var n=0;n<i.length;n++)r=i[n].split(":"),s=r[0],a=r[1],!(typeof s=="undefined"||typeof a=="undefined")&&(t[s]=a.replace(/\s/,""));return t},fr=function(e){for(var t={},i=cr(e),r=Math.max(i.length,e.style.length),s=0;s<r;s++){var a=e.style[s],n=i[s];a&&(t[a]=e.style[a]),n&&(t[n]=e.getAttribute(n))}return t},cr=function(e){for(var t=e.getAttributeNames(),i=["id","class","transform","xmlns","viewBox"],r=0;r<i.length;r++){var s=i[r],a=Array.prototype.indexOf.call(t,s);a>=0&&t.splice(a,1)}return t},ur=function(e,t){var i=t.split(/[\s,]/),r=-parseFloat(i[0]),s=-parseFloat(i[1]),a=parseFloat(i[2]),n=parseFloat(i[3]);if(r&&s)for(var o=0;o<e.children.length;o++){var l=e.children[o];"translation"in l?l.translation.add(r,s):"x"in l?l.x=r:"y"in l&&(l.y=s)}var h=typeof e.x=="number",_=typeof e.y=="number",d=typeof e.width=="number",c=typeof e.height=="number";return h&&(e.translation.x+=e.x),_&&(e.translation.y+=e.y),(d||c)&&(e.scale=new w(1,1)),d&&(e.scale.x=e.width/a),c&&(e.scale.y=e.height/n),e.mask=new se(0,0,a,n),e.mask.origin.set(-a/2,-n/2),e},xe=function(e,t,i){var r={},s={},a={},n,o,l,h,_,d,c,u,g,y,x,p,v;if(D.getComputedStyle){var k=D.getComputedStyle(e);for(n=k.length;n--;)l=k[n],h=k[l],typeof h!="undefined"&&(r[l]=h)}for(n=0;n<e.attributes.length;n++)d=e.attributes[n],/style/i.test(d.nodeName)?hr(d.value,a):s[d.nodeName]=d.value;typeof r.opacity!="undefined"&&(r["stroke-opacity"]=r.opacity,r["fill-opacity"]=r.opacity,delete r.opacity),i&&f.defaults(r,i),f.extend(r,a,s),r.visible=!(typeof r.display=="undefined"&&/none/i.test(r.display))||typeof r.visibility=="undefined"&&/hidden/i.test(r.visibility);for(l in r)switch(h=r[l],l){case"gradientTransform":if(/none/i.test(h)||(o=e.gradientTransform&&e.gradientTransform.baseVal&&e.gradientTransform.baseVal.length>0?e.gradientTransform.baseVal[0].matrix:e.getCTM?e.getCTM():null,o===null))break;switch(c=Ge(o),t._renderer.type){case"linear-gradient":Ai(c,t.left),Ai(c,t.right);break;case"radial-gradient":t.center.x+=c.translateX,t.center.y+=c.translateY,t.focal.x+=c.translateX,t.focal.y+=c.translateY,t.radius*=Math.max(c.scaleX,c.scaleY);break}break;case"transform":if(/none/i.test(h)||(o=e.transform&&e.transform.baseVal&&e.transform.baseVal.length>0?e.transform.baseVal[0].matrix:e.getCTM?e.getCTM():null,o===null))break;ee.AutoCalculateImportedMatrices?(c=Ge(o),t.translation.set(c.translateX,c.translateY),t.rotation=Math.PI*(c.rotation/180),t.scale=new w(c.scaleX,c.scaleY),u=parseFloat((r.x+"").replace("px")),g=parseFloat((r.y+"").replace("px")),u&&(t.translation.x=u),g&&(t.translation.y=g)):(o=e.getCTM(),t._matrix.manual=!0,t._matrix.set(o.a,o.b,o.c,o.d,o.e,o.f));break;case"visible":if(t instanceof te){t._visible=h;break}t.visible=h;break;case"stroke-linecap":if(t instanceof te){t._cap=h;break}t.cap=h;break;case"stroke-linejoin":if(t instanceof te){t._join=h;break}t.join=h;break;case"stroke-miterlimit":if(t instanceof te){t._miter=h;break}t.miter=h;break;case"stroke-width":if(t instanceof te){t._linewidth=parseFloat(h);break}t.linewidth=parseFloat(h);break;case"opacity":case"stroke-opacity":case"fill-opacity":if(t instanceof te){t._opacity=parseFloat(h);break}t.opacity=parseFloat(h);break;case"clip-path":if(Ee.cssBackgroundImage.test(h)&&(y=h.replace(Ee.cssBackgroundImage,"$1"),$.defs.current&&$.defs.current.contains(y)&&(p=$.defs.current.get(y),p&&p.childNodes.length>0)))switch(p=p.childNodes[0],v=lt(p.nodeName),t.mask=$[v].call(this,p,{}),t._renderer.type){case"text":case"path":t.position.add(t.mask.position),t.mask.position.clear();break}break;case"fill":case"stroke":_=(t instanceof te?"_":"")+l,Ee.cssBackgroundImage.test(h)?(y=h.replace(Ee.cssBackgroundImage,"$1"),$.defs.current&&$.defs.current.contains(y)?(p=$.defs.current.get(y),p.object||(v=lt(p.nodeName),p.object=$[v].call(this,p,{})),p=p.object):(x=_r(this),p=x.getById(y)),t[_]=p):t[_]=/none/i.test(h)?"transparent":h;break;case"id":t.id=h;break;case"class":case"className":t.classList=h.split(" ");break;case"x":case"y":var T=t instanceof B,S=t instanceof H,R=t instanceof W;if(T||S||R)break;if(h.match("[a-z%]$")&&!h.endsWith("px")){var C=new le("only pixel values are supported with the "+l+" attribute.");console.warn(C.name,C.message)}t.translation[l]=parseFloat(h);break;case"font-family":t instanceof Me&&(t.family=h);break;case"font-size":t instanceof Me&&(t.size=h);break;case"font-weight":t instanceof Me&&(t.weight=h);break;case"font-style":t instanceof Me&&(t.style=h);break;case"text-decoration":t instanceof Me&&(t.decoration=h);break;case"line-height":t instanceof Me&&(t.leading=h);break}return Object.keys(e.dataset).length&&(t.dataset=e.dataset),r},dr=function(e,t){for(var i=0,r=e.childNodes.length;i<r;i++){var s=e.childNodes[i];if(!!s.id){var a=lt(e.nodeName);a!=="#text"&&t.add(s.id,s)}}},_r=function(e){for(;e.parent;)e=e.parent;return e.scene},$={svg:function(e){for(var t=$.defs.current=new je,i=e.getElementsByTagName("defs"),r=0;r<i.length;r++)dr(i[r],t);var s=$.g.call(this,e),a=e.getAttribute("viewBox"),n=e.getAttribute("x"),o=e.getAttribute("y"),l=e.getAttribute("width"),h=e.getAttribute("height");s.defs=t;var _=a!==null,d=n!==null,c=o!==null,u=l!==null,g=h!==null;return d&&(s.x=parseFloat(n.replace(Ee.unitSuffix,""))),c&&(s.y=parseFloat(o.replace(Ee.unitSuffix,""))),u&&(s.width=parseFloat(l.replace(Ee.unitSuffix,""))),g&&(s.height=parseFloat(h.replace(Ee.unitSuffix,""))),_&&ur(s,a),delete $.defs.current,s},defs:function(e){return null},use:function(e,t){var i,r=e.getAttribute("href")||e.getAttribute("xlink:href");if(!r)return i=new le("encountered <use /> with no href."),console.warn(i.name,i.message),null;var s=r.slice(1);if(!$.defs.current.contains(s))return i=new le("unable to find element for reference "+r+"."),console.warn(i.name,i.message),null;for(var a=$.defs.current.get(s),n=a.cloneNode(!0),o=["x","y","width","height","href","xlink:href"],l=0;l<e.attributes.length;l++){var h=e.attributes[l],_=o.includes(h.nodeName),d=!n.hasAttribute(h.nodeName);(_||d)&&n.setAttribute(h.nodeName,h.value)}var c=lt(n.nodeName);return $[c].call(this,n,t)},g:function(e,t){var i,r=new te;xe.call(this,e,r,t),this.add(r),i=fr.call(this,e);for(var s=0,a=e.childNodes.length;s<a;s++){var n=e.childNodes[s],o=n.nodeName;if(!o)return;var l=lt(o);if(l in $){var h=$[l].call(r,n,i);!!h&&!h.parent&&r.add(h)}}return r.classList.length>0&&(r._flagClassName=!0),r},polygon:function(e,t){var i=e.getAttribute("points"),r=[];i.replace(/(-?[\d.eE-]+)[,|\s](-?[\d.eE-]+)/g,function(a,n,o){r.push(new M(parseFloat(n),parseFloat(o)))});var s=new A(r,!0).noStroke();return s.fill="black",xe.call(this,e,s,t),s},polyline:function(e,t){var i=$.polygon.call(this,e,t);return i.closed=!1,i},path:function(e,t){var i=e.getAttribute("d"),r=[],s=!1,a=!1;if(i){var n=new M,o,l,h=i.match(/[a-df-z][^a-df-z]*/ig),_=h.length-1;f.each(h.slice(0),function(c,u){var g=c.slice(1).trim().match(Ee.path),y=c[0],x=y.toLowerCase(),p,v,k,T,S,R=[];switch(u===0&&(h=[]),x){case"h":case"v":g.length>1&&(p=1);break;case"m":case"l":case"t":g.length>2&&(p=2);break;case"s":case"q":g.length>4&&(p=4);break;case"c":g.length>6&&(p=6);break;case"a":g.length>7&&(p=7);break}if(p){for(v=0,k=g.length,S=0;v<k;v+=p){if(T=y,S>0)switch(y){case"m":T="l";break;case"M":T="L";break}R.push(T+g.slice(v,v+p).join(" ")),S++}h=Array.prototype.concat.apply(h,R)}else h.push(c)}),f.each(h,function(c,u){var g,y,x,p=c[0],v=p.toLowerCase();l=c.slice(1).trim().match(Ee.path),a=p===v;var k,T,S,R,C,E,O,F,I;switch(v){case"z":if(u>=_)s=!0;else{y=n.x,x=n.y,g=new M(y,x,void 0,void 0,void 0,void 0,b.close);for(var j=r.length-1;j>=0;j--){var X=r[j];if(/m/i.test(X.command)){n=X;break}}}break;case"m":case"l":o=void 0,y=parseFloat(l[0]),x=parseFloat(l[1]),g=new M(y,x,void 0,void 0,void 0,void 0,/m/i.test(v)?b.move:b.line),a&&g.addSelf(n),n=g;break;case"h":case"v":var z=/h/i.test(v)?"x":"y",ne=/x/i.test(z)?"y":"x";g=new M(void 0,void 0,void 0,void 0,void 0,void 0,b.line),g[z]=parseFloat(l[0]),g[ne]=n[ne],a&&(g[z]+=n[z]),n=g;break;case"c":case"s":k=n.x,T=n.y,o||(o=new w),/c/i.test(v)?(S=parseFloat(l[0]),R=parseFloat(l[1]),C=parseFloat(l[2]),E=parseFloat(l[3]),O=parseFloat(l[4]),F=parseFloat(l[5])):(I=ct(n,o,a),S=I.x,R=I.y,C=parseFloat(l[0]),E=parseFloat(l[1]),O=parseFloat(l[2]),F=parseFloat(l[3])),a&&(S+=k,R+=T,C+=k,E+=T,O+=k,F+=T),f.isObject(n.controls)||M.AppendCurveProperties(n),n.controls.right.set(S-n.x,R-n.y),g=new M(O,F,C-O,E-F,void 0,void 0,b.curve),n=g,o=g.controls.left;break;case"t":case"q":k=n.x,T=n.y,o||(o=new w),/q/i.test(v)?(S=parseFloat(l[0]),R=parseFloat(l[1]),C=parseFloat(l[0]),E=parseFloat(l[1]),O=parseFloat(l[2]),F=parseFloat(l[3])):(I=ct(n,o,a),S=I.x,R=I.y,C=I.x,E=I.y,O=parseFloat(l[0]),F=parseFloat(l[1])),a&&(S+=k,R+=T,C+=k,E+=T,O+=k,F+=T),f.isObject(n.controls)||M.AppendCurveProperties(n),n.controls.right.set((S-n.x)*.33,(R-n.y)*.33),g=new M(O,F,C-O,E-F,void 0,void 0,b.curve),n=g,o=g.controls.left;break;case"a":k=n.x,T=n.y;var ke=parseFloat(l[0]),we=parseFloat(l[1]),Q=parseFloat(l[2]),G=parseFloat(l[3]),Je=parseFloat(l[4]);O=parseFloat(l[5]),F=parseFloat(l[6]),a&&(O+=k,F+=T);var ie=new M(O,F);ie.command=b.arc,ie.rx=ke,ie.ry=we,ie.xAxisRotation=Q,ie.largeArcFlag=G,ie.sweepFlag=Je,g=ie,n=ie,o=void 0;break}g&&(Array.isArray(g)?r=r.concat(g):r.push(g))})}i=new A(r,s,void 0,!0).noStroke(),i.fill="black";var d=i.getBoundingClientRect(!0);return d.centroid={x:d.left+d.width/2,y:d.top+d.height/2},f.each(i.vertices,function(c){c.subSelf(d.centroid)}),xe.call(this,e,i,t),i.translation.addSelf(d.centroid),i},circle:function(e,t){var i=parseFloat(e.getAttribute("cx")),r=parseFloat(e.getAttribute("cy")),s=parseFloat(e.getAttribute("r")),a=new st(0,0,s).noStroke();return a.fill="black",xe.call(this,e,a,t),a.translation.x=i,a.translation.y=r,a},ellipse:function(e,t){var i=parseFloat(e.getAttribute("cx")),r=parseFloat(e.getAttribute("cy")),s=parseFloat(e.getAttribute("rx")),a=parseFloat(e.getAttribute("ry")),n=new nt(0,0,s,a).noStroke();return n.fill="black",xe.call(this,e,n,t),n.translation.x=i,n.translation.y=r,n},rect:function(e,t){var i=parseFloat(e.getAttribute("rx")),r=parseFloat(e.getAttribute("ry"));if(!f.isNaN(i)||!f.isNaN(r))return $["rounded-rect"](e);var s=parseFloat(e.getAttribute("width")),a=parseFloat(e.getAttribute("height")),n=s/2,o=a/2,l=new se(0,0,s,a).noStroke();return l.fill="black",xe.call(this,e,l,t),l.translation.x+=n,l.translation.y+=o,l},"rounded-rect":function(e,t){var i=parseFloat(e.getAttribute("rx"))||0,r=parseFloat(e.getAttribute("ry"))||0,s=parseFloat(e.getAttribute("width")),a=parseFloat(e.getAttribute("height")),n=s/2,o=a/2,l=new w(i,r),h=new ot(0,0,s,a,l).noStroke();return h.fill="black",xe.call(this,e,h,t),h.translation.x+=n,h.translation.y+=o,h},line:function(e,t){var i=parseFloat(e.getAttribute("x1")),r=parseFloat(e.getAttribute("y1")),s=parseFloat(e.getAttribute("x2")),a=parseFloat(e.getAttribute("y2")),n=new at(i,r,s,a).noFill();return xe.call(this,e,n,t),n},lineargradient:function(e,t){var i=e.getAttribute("gradientUnits"),r=e.getAttribute("spreadMethod");i||(i="objectBoundingBox"),r||(r="pad");var s=parseFloat(e.getAttribute("x1")||0),a=parseFloat(e.getAttribute("y1")||0),n=parseFloat(e.getAttribute("x2")||0),o=parseFloat(e.getAttribute("y2")||0),l=(n+s)/2,h=(o+a)/2;/userSpaceOnUse/i.test(i)&&(s-=l,a-=h,n-=l,o-=h);for(var _=[],d=0;d<e.children.length;d++){var c=e.children[d],u=c.getAttribute("offset");/%/ig.test(u)&&(u=parseFloat(u.replace(/%/ig,""))/100),u=parseFloat(u);var g=c.getAttribute("stop-color"),y=c.getAttribute("stop-opacity"),x=c.getAttribute("style"),p;g===null&&(p=x?x.match(/stop-color:\s?([#a-fA-F0-9]*)/):!1,g=p&&p.length>1?p[1]:void 0),y===null?(p=x?x.match(/stop-opacity:\s?([0-9.-]*)/):!1,y=p&&p.length>1?parseFloat(p[1]):1):y=parseFloat(y),_.push(new Te(u,g,y))}var v=new H(s,a,n,o,_);return v.spread=r,v.units=i,xe.call(this,e,v,t),v},radialgradient:function(e,t){var i=e.getAttribute("gradientUnits"),r=e.getAttribute("spreadMethod");i||(i="objectBoundingBox"),r||(r="pad");var s=parseFloat(e.getAttribute("cx"))||0,a=parseFloat(e.getAttribute("cy"))||0,n=parseFloat(e.getAttribute("r")),o=parseFloat(e.getAttribute("fx")),l=parseFloat(e.getAttribute("fy"));f.isNaN(o)&&(o=s),f.isNaN(l)&&(l=a);var h=Math.abs(s+o)/2,_=Math.abs(a+l)/2;/userSpaceOnUse/i.test(i)&&(s-=h,a-=_,o-=h,l-=_);for(var d=[],c=0;c<e.children.length;c++){var u=e.children[c],g=u.getAttribute("offset");/%/ig.test(g)&&(g=parseFloat(g.replace(/%/ig,""))/100),g=parseFloat(g);var y=u.getAttribute("stop-color"),x=u.getAttribute("stop-opacity"),p=u.getAttribute("style"),v;y===null&&(v=p?p.match(/stop-color:\s?([#a-fA-F0-9]*)/):!1,y=v&&v.length>1?v[1]:void 0),x===null?(v=p?p.match(/stop-opacity:\s?([0-9.-]*)/):!1,x=v&&v.length>1?parseFloat(v[1]):1):x=parseFloat(x),d.push(new Te(g,y,x))}var k=new W(s,a,n,d,o,l);return xe.call(this,e,k,t),k},text:function(e,t){var i=or(e.getAttribute("text-anchor"))||"left",r=lr(e)||"baseline",s=e.textContent,a=new Me(s);return xe.call(this,e,a,t),a.alignment=i,a.baseline=r,a},clippath:function(e,t){return $.defs.current&&!$.defs.current.contains(e.id)&&$.defs.current.add(e.id,e),null},image:function(e,t){var i=e.getAttribute("href")||e.getAttribute("xlink:href");if(!i){var r=new le("encountered <image /> with no href.");return console.warn(r.name,r.message),null}var s=parseFloat(e.getAttribute("x"))||0,a=parseFloat(e.getAttribute("y"))||0,n=parseFloat(e.getAttribute("width")),o=parseFloat(e.getAttribute("height")),l=new rt(i,s,a);return f.isNaN(n)||(l.width=n),f.isNaN(o)||(l.height=o),xe.call(this,e,l,t),l}},St=$;function pr(e,t){var i=new XMLHttpRequest;return i.open("GET",e),i.onreadystatechange=function(){i.readyState===4&&i.status===200&&t(i.responseText)},i.send(),i}var ti=pr;function _e(e,t,i,r){A.call(this,[new M,new M,new M,new M],!0),this._renderer.flagTextures=_e.FlagTextures.bind(this),this._renderer.bindTextures=_e.BindTextures.bind(this),this._renderer.unbindTextures=_e.UnbindTextures.bind(this),this.noStroke(),this.noFill(),Array.isArray(e)?this.textures=e.map(_e.GenerateTexture.bind(this)):this.textures=[_e.GenerateTexture(e)],this.origin=new w,this._update(),this.translation.set(t||0,i||0),typeof r=="number"?this.frameRate=r:this.frameRate=_e.DefaultFrameRate,this.index=0}f.extend(_e,{Properties:["frameRate","index"],DefaultFrameRate:30,FlagTextures:function(){this._flagTextures=!0},BindTextures:function(e){for(var t=e.length;t--;)e[t].bind(m.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()},UnbindTextures:function(e){for(var t=e.length;t--;)e[t].unbind(m.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()},MakeObservable:function(e){se.MakeObservable(e),f.each(_e.Properties,N,e),Object.defineProperty(e,"textures",{enumerable:!0,get:function(){return this._textures},set:function(t){var i=this._renderer.bindTextures,r=this._renderer.unbindTextures;this._textures&&this._textures.unbind(m.Types.insert,i).unbind(m.Types.remove,r),this._textures=new fe((t||[]).slice(0)),this._textures.bind(m.Types.insert,i).bind(m.Types.remove,r),i(this._textures)}})},GenerateTexture:function(e){if(e instanceof V)return e;if(typeof e=="string")return new V(e)}});f.extend(_e.prototype,se.prototype,{constructor:_e,_flagTextures:!1,_flagFrameRate:!1,_flagIndex:!1,_amount:1,_duration:0,_index:0,_startTime:0,_playing:!1,_firstFrame:0,_lastFrame:0,_loop:!0,_textures:null,_frameRate:0,_origin:null,play:function(e,t,i){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=f.performance.now(),typeof e=="number"&&(this._firstFrame=e),typeof t=="number"&&(this._lastFrame=t),typeof i=="function"?this._onLastFrame=i:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this},pause:function(){return this._playing=!1,this},stop:function(){return this._playing=!1,this._index=this._firstFrame,this},clone:function(e){var t=new _e(this.textures,this.translation.x,this.translation.y,this.frameRate);return t._loop=this._loop,this._playing&&t.play(),e&&e.add(t),t},toObject:function(){var e=se.prototype.toObject.call(this);return e.textures=this.textures.map(function(t){return t.toObject()}),e.frameRate=this.frameRate,e.index=this.index,e._firstFrame=this._firstFrame,e._lastFrame=this._lastFrame,e._loop=this._loop,e},_update:function(){var e=this._textures,t,i,r,s,a,n,o,l;return this._flagTextures&&(this._amount=e.length),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._playing&&this._frameRate>0?(s=this._amount,f.isNaN(this._lastFrame)&&(this._lastFrame=s-1),r=f.performance.now()-this._startTime,l=this._lastFrame+1,a=1e3*(l-this._firstFrame)/this._frameRate,this._loop?r=r%a:r=Math.min(r,a),o=ae(this._firstFrame,l,r/a),o=Math.floor(o),o!==this._index&&(this._index=o,n=e[this._index],n.loaded&&(t=n.image.width,i=n.image.height,this.width!==t&&(this.width=t),this.height!==i&&(this.height=i),this.fill=n,o>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()))):(this._flagIndex||!(this.fill instanceof V))&&(n=e[this._index],n.loaded&&(t=n.image.width,i=n.image.height,this.width!==t&&(this.width=t),this.height!==i&&(this.height=i)),this.fill=n),se.prototype._update.call(this),this},flagReset:function(){return this._flagTextures=this._flagFrameRate=!1,se.prototype.flagReset.call(this),this}});_e.MakeObservable(_e.prototype);var ii=_e;function Ne(e,t,i,r,s,a,n){for(var o=n||ee.Resolution*3,l=[],h=0;h<o;h++)l.push(new M);A.call(this,l,!0,!1,!0),typeof i=="number"&&(this.innerRadius=i),typeof r=="number"&&(this.outerRadius=r),typeof s=="number"&&(this.startAngle=s),typeof a=="number"&&(this.endAngle=a),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}f.extend(Ne,{Properties:["startAngle","endAngle","innerRadius","outerRadius"],MakeObservable:function(e){A.MakeObservable(e),f.each(Ne.Properties,N,e)}});f.extend(Ne.prototype,A.prototype,{constructor:Ne,_flagStartAngle:!1,_flagEndAngle:!1,_flagInnerRadius:!1,_flagOuterRadius:!1,_startAngle:0,_endAngle:K,_innerRadius:0,_outerRadius:0,_update:function(){if(this._flagVertices||this._flagStartAngle||this._flagEndAngle||this._flagInnerRadius||this._flagOuterRadius){var e=this._startAngle,t=this._endAngle,i=this._innerRadius,r=this._outerRadius,s=re(e,K)===re(t,K),a=i>0,n=this.vertices,o=a?n.length/2:n.length,l,h=0;s?o--:a||(o-=2);for(var _=0,d=o-1;_<o;_++){var c=_/d,u=n[h],g=c*(t-e)+e,y=(t-e)/o,x=r*Math.cos(g),p=r*Math.sin(g);switch(_){case 0:l=b.move;break;default:l=b.curve}if(u.command=l,u.x=x,u.y=p,u.controls.left.clear(),u.controls.right.clear(),u.command===b.curve){var v=r*y/Math.PI;u.controls.left.x=v*Math.cos(g-J),u.controls.left.y=v*Math.sin(g-J),u.controls.right.x=v*Math.cos(g+J),u.controls.right.y=v*Math.sin(g+J),_===1&&u.controls.left.multiplyScalar(2),_===d&&u.controls.right.multiplyScalar(2)}h++}if(a){for(s?(n[h].command=b.close,h++):(o--,d=o-1),_=0;_<o;_++)c=_/d,u=n[h],g=(1-c)*(t-e)+e,y=(t-e)/o,x=i*Math.cos(g),p=i*Math.sin(g),l=b.curve,_<=0&&(l=s?b.move:b.line),u.command=l,u.x=x,u.y=p,u.controls.left.clear(),u.controls.right.clear(),u.command===b.curve&&(v=i*y/Math.PI,u.controls.left.x=v*Math.cos(g+J),u.controls.left.y=v*Math.sin(g+J),u.controls.right.x=v*Math.cos(g-J),u.controls.right.y=v*Math.sin(g-J),_===1&&u.controls.left.multiplyScalar(2),_===d&&u.controls.right.multiplyScalar(2)),h++;n[h].copy(n[0]),n[h].command=b.line}else s||(n[h].command=b.line,n[h].x=0,n[h].y=0,h++,n[h].copy(n[0]),n[h].command=b.line)}return A.prototype._update.call(this),this},flagReset:function(){return A.prototype.flagReset.call(this),this._flagStartAngle=this._flagEndAngle=this._flagInnerRadius=this._flagOuterRadius=!1,this},clone:function(e){var t=this.innerRadius,i=this.outerRadius,r=this.startAngle,s=this.endAngle,a=this.vertices.length,n=new Ne(0,0,t,i,r,s,a);return n.translation.copy(this.translation),n.rotation=this.rotation,n.scale=this.scale,n.skewX=this.skewX,n.skewY=this.skewY,this.matrix.manual&&n.matrix.copy(this.matrix),f.each(A.Properties,function(o){n[o]=this[o]},this),e&&e.add(n),n},toObject:function(){var e=A.prototype.toObject.call(this);return f.each(Ne.Properties,function(t){e[t]=this[t]},this),e}});Ne.MakeObservable(Ne.prototype);var ri=Ne;var gr=Math.ceil,mr=Math.floor;function Re(e){Y.call(this),this._renderer.type="points",this._renderer.flagVertices=A.FlagVertices.bind(this),this._renderer.bindVertices=A.BindVertices.bind(this),this._renderer.unbindVertices=A.UnbindVertices.bind(this),this._renderer.flagFill=A.FlagFill.bind(this),this._renderer.flagStroke=A.FlagStroke.bind(this),this._renderer.vertices=null,this._renderer.collection=null,this.sizeAttenuation=!1,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.className="",this.visible=!0,this.vertices=e,this.dashes=[],this.dashes.offset=0}f.extend(Re,{Properties:["fill","stroke","linewidth","opacity","visible","size","sizeAttenuation","beginning","ending"],MakeObservable:function(e){Y.MakeObservable(e),f.each(Re.Properties.slice(2,7),N,e),Object.defineProperty(e,"fill",{enumerable:!0,get:function(){return this._fill},set:function(t){(this._fill instanceof B||this._fill instanceof H||this._fill instanceof W||this._fill instanceof V)&&this._fill.unbind(m.Types.change,this._renderer.flagFill),this._fill=t,this._flagFill=!0,(this._fill instanceof B||this._fill instanceof H||this._fill instanceof W||this._fill instanceof V)&&this._fill.bind(m.Types.change,this._renderer.flagFill)}}),Object.defineProperty(e,"stroke",{enumerable:!0,get:function(){return this._stroke},set:function(t){(this._stroke instanceof B||this._stroke instanceof H||this._stroke instanceof W||this._stroke instanceof V)&&this._stroke.unbind(m.Types.change,this._renderer.flagStroke),this._stroke=t,this._flagStroke=!0,(this._stroke instanceof B||this._stroke instanceof H||this._stroke instanceof W||this._stroke instanceof V)&&this._stroke.bind(m.Types.change,this._renderer.flagStroke)}}),Object.defineProperty(e,"length",{get:function(){return this._flagLength&&this._updateLength(),this._length}}),Object.defineProperty(e,"beginning",{enumerable:!0,get:function(){return this._beginning},set:function(t){this._beginning=t,this._flagVertices=!0}}),Object.defineProperty(e,"ending",{enumerable:!0,get:function(){return this._ending},set:function(t){this._ending=t,this._flagVertices=!0}}),Object.defineProperty(e,"vertices",{enumerable:!0,get:function(){return this._collection},set:function(t){var i=this._renderer.bindVertices,r=this._renderer.unbindVertices;this._collection&&this._collection.unbind(m.Types.insert,i).unbind(m.Types.remove,r),t instanceof fe?this._collection=t:this._collection=new fe(t||[]),this._collection.bind(m.Types.insert,i).bind(m.Types.remove,r),i(this._collection)}}),Object.defineProperty(e,"dashes",{enumerable:!0,get:function(){return this._dashes},set:function(t){typeof t.offset!="number"&&(t.offset=this.dashes&&this._dashes.offset||0),this._dashes=t}})}});f.extend(Re.prototype,Y.prototype,{constructor:Re,_flagVertices:!0,_flagLength:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagSize:!0,_flagSizeAttenuation:!0,_length:0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_size:1,_sizeAttenuation:!1,_beginning:0,_ending:1,_dashes:null,clone:function(e){for(var t=new Re,i=0;i<this.vertices.length;i++)t.vertices.push(this.vertices[i].clone());for(var r=0;r<Re.Properties.length;r++){var s=Re.Properties[r];t[s]=this[s]}return t.className=this.className,t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),e&&e.add(t),t._update()},toObject:function(){var e={vertices:this.vertices.map(function(t){return t.toObject()})};return f.each(Re.Properties,function(t){e[t]=this[t]},this),e.className=this.className,e.translation=this.translation.toObject(),e.rotation=this.rotation,e.scale=this.scale instanceof w?this.scale.toObject():this.scale,e.skewX=this.skewX,e.skewY=this.skewY,this.matrix.manual&&(e.matrix=this.matrix.toObject()),e},noFill:A.prototype.noFill,noStroke:A.prototype.noStroke,corner:A.prototype.corner,center:A.prototype.center,remove:A.prototype.remove,getBoundingClientRect:A.prototype.getBoundingClientRect,subdivide:function(e){this._update();for(var t=[],i=0;i<this.vertices.length;i++){var r=this.vertices[i],s=this.vertices[i-1];if(!!s){var a=r.x,n=r.y,o=s.x,l=s.y,h=et(a,n,a,n,o,l,o,l,e);t=t.concat(h)}}return this.vertices=t,this},_updateLength:A.prototype._updateLength,_update:function(){if(this._flagVertices){this._flagLength&&this._updateLength(void 0,!0);var e=Math.min(this._beginning,this._ending),t=Math.max(this._beginning,this._ending),i=it(this,e*this._length),r=it(this,t*this._length),s=gr(i),a=mr(r);this._renderer.vertices=[],this._renderer.collection=[];for(var n=0,o,l=0;l<this._collection.length;l++)l>=s&&l<=a&&(o=this._collection[l],this._renderer.collection.push(o),this._renderer.vertices[n*2+0]=o.x,this._renderer.vertices[n*2+1]=o.y,n++)}return Y.prototype._update.apply(this,arguments),this},flagReset:function(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagSize=this._flagSizeAttenuation=!1,Y.prototype.flagReset.call(this),this}});Re.MakeObservable(Re.prototype);var si=Re;var vr=Math.cos,yr=Math.sin;function Ve(e,t,i,r){r=Math.max(r||0,3),A.call(this),this.closed=!0,this.automatic=!1,typeof i=="number"&&(this.width=i*2),typeof i=="number"&&(this.height=i*2),typeof r=="number"&&(this.sides=r),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}f.extend(Ve,{Properties:["width","height","sides"],MakeObservable:function(e){A.MakeObservable(e),f.each(Ve.Properties,N,e)}});f.extend(Ve.prototype,A.prototype,{constructor:Ve,_flagWidth:!1,_flagHeight:!1,_flagSides:!1,_width:0,_height:0,_sides:0,_update:function(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagSides){var e=this._sides,t=e+1,i=this.vertices.length;i>e&&(this.vertices.splice(e-1,i-e),i=e);for(var r=0;r<t;r++){var s=(r+.5)/e,a=K*s+Math.PI/2,n=this._width*vr(a)/2,o=this._height*yr(a)/2;r>=i?this.vertices.push(new M(n,o)):this.vertices[r].set(n,o),this.vertices[r].command=r===0?b.move:b.line}}return A.prototype._update.call(this),this},flagReset:function(){return this._flagWidth=this._flagHeight=this._flagSides=!1,A.prototype.flagReset.call(this),this},clone:function(e){var t=new Ve(0,0,this.radius,this.sides);return t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&t.matrix.copy(this.matrix),f.each(A.Properties,function(i){t[i]=this[i]},this),e&&e.add(t),t},toObject:function(){var e=A.prototype.toObject.call(this);return f.each(Ve.Properties,function(t){e[t]=this[t]},this),e}});Ve.MakeObservable(Ve.prototype);var ni=Ve;var xr=Math.cos,br=Math.sin;function ze(e,t,i,r,s){arguments.length<=3&&(r=i,i=r/2),(typeof s!="number"||s<=0)&&(s=5),A.call(this),this.closed=!0,this.automatic=!1,typeof i=="number"&&(this.innerRadius=i),typeof r=="number"&&(this.outerRadius=r),typeof s=="number"&&(this.sides=s),this._update(),typeof e=="number"&&(this.translation.x=e),typeof t=="number"&&(this.translation.y=t)}f.extend(ze,{Properties:["innerRadius","outerRadius","sides"],MakeObservable:function(e){A.MakeObservable(e),f.each(ze.Properties,N,e)}});f.extend(ze.prototype,A.prototype,{constructor:ze,_flagInnerRadius:!1,_flagOuterRadius:!1,_flagSides:!1,_innerRadius:0,_outerRadius:0,_sides:0,_update:function(){if(this._flagVertices||this._flagInnerRadius||this._flagOuterRadius||this._flagSides){var e=this._sides*2,t=e+1,i=this.vertices.length;i>e&&(this.vertices.splice(e-1,i-e),i=e);for(var r=0;r<t;r++){var s=(r+.5)/e,a=K*s,n=(r%2?this._outerRadius:this._innerRadius)/2,o=n*xr(a),l=n*br(a);r>=i?this.vertices.push(new M(o,l)):this.vertices[r].set(o,l),this.vertices[r].command=r===0?b.move:b.line}}return A.prototype._update.call(this),this},flagReset:function(){return this._flagInnerRadius=this._flagOuterRadius=this._flagSides=!1,A.prototype.flagReset.call(this),this},clone:function(e){var t=this.innerRadius,i=this.outerRadius,r=this.sides,s=new ze(0,0,t,i,r);return s.translation.copy(this.translation),s.rotation=this.rotation,s.scale=this.scale,s.skewX=this.skewX,s.skewY=this.skewY,this.matrix.manual&&s.matrix.copy(this.matrix),f.each(A.Properties,function(a){s[a]=this[a]},this),e&&e.add(s),s},toObject:function(){var e=A.prototype.toObject.call(this);return f.each(ze.Properties,function(t){e[t]=this[t]},this),e}});ze.MakeObservable(ze.prototype);var ai=ze;var Ti=new Ae,P={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",alignments:{left:"start",center:"middle",right:"end"},createElement:function(e,t){var i=e,r=document.createElementNS(P.ns,i);return i==="svg"&&(t=f.defaults(t||{},{version:P.version})),t&&Object.keys(t).length>0&&P.setAttributes(r,t),r},setAttributes:function(e,t){for(var i=Object.keys(t),r=0;r<i.length;r++)/href/.test(i[r])?e.setAttributeNS(P.xlink,i[r],t[i[r]]):e.setAttribute(i[r],t[i[r]]);return this},removeAttributes:function(e,t){for(var i in t)e.removeAttribute(i);return this},toString:function(e,t){for(var i=e.length,r=i-1,s,a="",n=0;n<i;n++){var o=e[n],l,h=t?re(n-1,i):Math.max(n-1,0),_=e[h],d,c,u,g,y,x,p,v,k,T,S,R,C,E,O=q(o.x),F=q(o.y);switch(o.command){case b.close:l=b.close;break;case b.arc:T=o.rx,S=o.ry,R=o.xAxisRotation,C=o.largeArcFlag,E=o.sweepFlag,l=b.arc+" "+T+" "+S+" "+R+" "+C+" "+E+" "+O+" "+F;break;case b.curve:y=_.controls&&_.controls.right||w.zero,x=o.controls&&o.controls.left||w.zero,_.relative?(d=q(y.x+_.x),c=q(y.y+_.y)):(d=q(y.x),c=q(y.y)),o.relative?(u=q(x.x+o.x),g=q(x.y+o.y)):(u=q(x.x),g=q(x.y)),l=(n===0?b.move:b.curve)+" "+d+" "+c+" "+u+" "+g+" "+O+" "+F;break;case b.move:s=o,l=b.move+" "+O+" "+F;break;default:l=o.command+" "+O+" "+F}n>=r&&t&&(o.command===b.curve&&(v=s,p=o.controls&&o.controls.right||o,k=v.controls&&v.controls.left||v,o.relative?(d=q(p.x+o.x),c=q(p.y+o.y)):(d=q(p.x),c=q(p.y)),v.relative?(u=q(k.x+v.x),g=q(k.y+v.y)):(u=q(k.x),g=q(k.y)),O=q(v.x),F=q(v.y),l+=" C "+d+" "+c+" "+u+" "+g+" "+O+" "+F),o.command!==b.close&&(l+=" Z")),a+=l+" "}return a},pointsToString:function(e,t){for(var i="",r=t*.5,s=0;s<e.length;s++){var a=e[s].x,n=e[s].y-r;i+=b.move+" "+a+" "+n+" ",i+="a "+r+" "+r+" 0 1 0 0.001 0 Z"}return i},getClip:function(e,t){var i=e._renderer.clip;return i||(i=e._renderer.clip=P.createElement("clipPath",{"clip-rule":"nonzero"}),t.defs.appendChild(i)),i},group:{appendChild:function(e){var t=e._renderer.elem;if(!!t){var i=t.nodeName;!i||/(radial|linear)gradient/i.test(i)||e._clip||this.elem.appendChild(t)}},removeChild:function(e){var t=e._renderer.elem;if(!(!t||t.parentNode!=this.elem)){var i=t.nodeName;!i||e._clip||this.elem.removeChild(t)}},orderChild:function(e){this.elem.appendChild(e._renderer.elem)},renderChild:function(e){P[e._renderer.type].render.call(e,this)},render:function(e){if(!this._visible&&!this._flagVisible||this._opacity===0&&!this._flagOpacity)return this;this._update(),this._renderer.elem||(this._renderer.elem=P.createElement("g",{id:this.id}),e.appendChild(this._renderer.elem));var t=this._matrix.manual||this._flagMatrix,i={domElement:e,elem:this._renderer.elem};t&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");for(var r=0;r<this.children.length;r++){var s=this.children[r];P[s._renderer.type].render.call(s,e)}if(this._flagId&&this._renderer.elem.setAttribute("id",this._id),this._flagOpacity&&this._renderer.elem.setAttribute("opacity",this._opacity),this._flagVisible&&this._renderer.elem.setAttribute("display",this._visible?"inline":"none"),this._flagClassName&&this._renderer.elem.setAttribute("class",this.classList.join(" ")),this._flagAdditions&&this.additions.forEach(P.group.appendChild,i),this._flagSubtractions&&this.subtractions.forEach(P.group.removeChild,i),this._flagOrder&&this.children.forEach(P.group.orderChild,i),this._flagMask&&(this._mask?(P[this._mask._renderer.type].render.call(this._mask,e),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.dataset)for(var a in this.dataset)this._renderer.elem.setAttribute("data-"+a,this.dataset[a]);return this.flagReset()}},path:{render:function(e){if(this._opacity===0&&!this._flagOpacity)return this;this._update();var t={},i=this._matrix.manual||this._flagMatrix;if(i&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagVertices){var r=P.toString(this._renderer.vertices,this._closed);t.d=r}if(this._fill&&this._fill._renderer&&(this._fill._update(),P[this._fill._renderer.type].render.call(this._fill,e,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._stroke&&this._stroke._renderer&&(this._stroke._update(),P[this._stroke._renderer.type].render.call(this._stroke,e,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t["stroke-opacity"]=this._opacity,t["fill-opacity"]=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this._flagCap&&(t["stroke-linecap"]=this._cap),this._flagJoin&&(t["stroke-linejoin"]=this._join),this._flagMiter&&(t["stroke-miterlimit"]=this._miter),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?P.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=P.createElement("path",t),e.appendChild(this._renderer.elem)),this._flagClip){var s=P.getClip(this,e),a=this._renderer.elem;this._clip?(a.removeAttribute("id"),s.setAttribute("id",this.id),s.appendChild(a)):(s.removeAttribute("id"),a.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(a))}return this._flagMask&&(this._mask?(P[this._mask._renderer.type].render.call(this._mask,e),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.flagReset()}},points:{render:function(e){if(this._opacity===0&&!this._flagOpacity)return this;this._update();var t={},i=this._matrix.manual||this._flagMatrix;if(i&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagVertices||this._flagSize||this._flagSizeAttenuation){var r=this._size;if(!this._sizeAttenuation){Se(this,Ti);var s=Ti.elements,a=Ge(s[0],s[3],s[1],s[4],s[2],s[5]);r/=Math.max(a.scaleX,a.scaleY)}var n=P.pointsToString(this._renderer.collection,r);t.d=n}return this._fill&&this._fill._renderer&&(this._fill._update(),P[this._fill._renderer.type].render.call(this._fill,e,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._stroke&&this._stroke._renderer&&(this._stroke._update(),P[this._stroke._renderer.type].render.call(this._stroke,e,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t["stroke-opacity"]=this._opacity,t["fill-opacity"]=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?P.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=P.createElement("path",t),e.appendChild(this._renderer.elem)),this.flagReset()}},text:{render:function(e){this._update();var t={},i=this._matrix.manual||this._flagMatrix;if(i&&(t.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(t.id=this._id),this._flagFamily&&(t["font-family"]=this._family),this._flagSize&&(t["font-size"]=this._size),this._flagLeading&&(t["line-height"]=this._leading),this._flagAlignment&&(t["text-anchor"]=P.alignments[this._alignment]||this._alignment),this._flagBaseline&&(t["alignment-baseline"]=t["dominant-baseline"]=this._baseline),this._flagStyle&&(t["font-style"]=this._style),this._flagWeight&&(t["font-weight"]=this._weight),this._flagDecoration&&(t["text-decoration"]=this._decoration),this._fill&&this._fill._renderer&&(this._fill._update(),P[this._fill._renderer.type].render.call(this._fill,e,!0)),this._flagFill&&(t.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._stroke&&this._stroke._renderer&&(this._stroke._update(),P[this._stroke._renderer.type].render.call(this._stroke,e,!0)),this._flagStroke&&(t.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(t["stroke-width"]=this._linewidth),this._flagOpacity&&(t.opacity=this._opacity),this._flagClassName&&(t.class=this.classList.join(" ")),this._flagVisible&&(t.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(t["stroke-dasharray"]=this.dashes.join(" "),t["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?P.setAttributes(this._renderer.elem,t):(t.id=this._id,this._renderer.elem=P.createElement("text",t),e.defs.appendChild(this._renderer.elem)),this._flagClip){var r=P.getClip(this,e),s=this._renderer.elem;this._clip?(s.removeAttribute("id"),r.setAttribute("id",this.id),r.appendChild(s)):(r.removeAttribute("id"),s.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(s))}return this._flagMask&&(this._mask?(P[this._mask._renderer.type].render.call(this._mask,e),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this._flagValue&&(this._renderer.elem.textContent=this._value),this.flagReset()}},"linear-gradient":{render:function(e,t){t||this._update();var i={};if(this._flagId&&(i.id=this._id),this._flagEndPoints&&(i.x1=this.left._x,i.y1=this.left._y,i.x2=this.right._x,i.y2=this.right._y),this._flagSpread&&(i.spreadMethod=this._spread),this._flagUnits&&(i.gradientUnits=this._units),this._renderer.elem?P.setAttributes(this._renderer.elem,i):(i.id=this._id,this._renderer.elem=P.createElement("linearGradient",i),e.defs.appendChild(this._renderer.elem)),this._flagStops){var r=this._renderer.elem.childNodes.length!==this.stops.length;if(r)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(var s=0;s<this.stops.length;s++){var a=this.stops[s],n={};a._flagOffset&&(n.offset=100*a._offset+"%"),a._flagColor&&(n["stop-color"]=a._color),a._flagOpacity&&(n["stop-opacity"]=a._opacity),a._renderer.elem?P.setAttributes(a._renderer.elem,n):a._renderer.elem=P.createElement("stop",n),r&&this._renderer.elem.appendChild(a._renderer.elem),a.flagReset()}}return this.flagReset()}},"radial-gradient":{render:function(e,t){t||this._update();var i={};if(this._flagId&&(i.id=this._id),this._flagCenter&&(i.cx=this.center._x,i.cy=this.center._y),this._flagFocal&&(i.fx=this.focal._x,i.fy=this.focal._y),this._flagRadius&&(i.r=this._radius),this._flagSpread&&(i.spreadMethod=this._spread),this._flagUnits&&(i.gradientUnits=this._units),this._renderer.elem?P.setAttributes(this._renderer.elem,i):(i.id=this._id,this._renderer.elem=P.createElement("radialGradient",i),e.defs.appendChild(this._renderer.elem)),this._flagStops){var r=this._renderer.elem.childNodes.length!==this.stops.length;if(r)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(var s=0;s<this.stops.length;s++){var a=this.stops[s],n={};a._flagOffset&&(n.offset=100*a._offset+"%"),a._flagColor&&(n["stop-color"]=a._color),a._flagOpacity&&(n["stop-opacity"]=a._opacity),a._renderer.elem?P.setAttributes(a._renderer.elem,n):a._renderer.elem=P.createElement("stop",n),r&&this._renderer.elem.appendChild(a._renderer.elem),a.flagReset()}}return this.flagReset()}},texture:{render:function(e,t){t||this._update();var i={},r={x:0,y:0},s=this.image;if(this._flagId&&(i.id=this._id),this._flagLoaded&&this.loaded)switch(s.nodeName.toLowerCase()){case"canvas":r.href=r["xlink:href"]=s.toDataURL("image/png");break;case"img":case"image":r.href=r["xlink:href"]=this.src;break}if((this._flagOffset||this._flagLoaded||this._flagScale)&&(i.x=this._offset.x,i.y=this._offset.y,s&&(i.x-=s.width/2,i.y-=s.height/2,this._scale instanceof w?(i.x*=this._scale.x,i.y*=this._scale.y):(i.x*=this._scale,i.y*=this._scale)),i.x>0&&(i.x*=-1),i.y>0&&(i.y*=-1)),(this._flagScale||this._flagLoaded||this._flagRepeat)&&(i.width=0,i.height=0,s)){switch(r.width=i.width=s.width,r.height=i.height=s.height,this._repeat){case"no-repeat":i.width+=1,i.height+=1;break}this._scale instanceof w?(i.width*=this._scale.x,i.height*=this._scale.y):(i.width*=this._scale,i.height*=this._scale)}return(this._flagScale||this._flagLoaded)&&(this._renderer.image?P.setAttributes(this._renderer.image,r):this._renderer.image=P.createElement("image",r)),this._renderer.elem?Object.keys(i).length!==0&&P.setAttributes(this._renderer.elem,i):(i.id=this._id,i.patternUnits="userSpaceOnUse",this._renderer.elem=P.createElement("pattern",i),e.defs.appendChild(this._renderer.elem)),this._renderer.elem&&this._renderer.image&&!this._renderer.appended&&(this._renderer.elem.appendChild(this._renderer.image),this._renderer.appended=!0),this.flagReset()}}};function At(e){this.domElement=e.domElement||P.createElement("svg"),this.scene=new te,this.scene.parent=this,this.defs=P.createElement("defs"),this.domElement.appendChild(this.defs),this.domElement.defs=this.defs,this.domElement.style.overflow="hidden"}f.extend(At,{Utils:P});f.extend(At.prototype,m,{constructor:At,setSize:function(e,t){return this.width=e,this.height=t,P.setAttributes(this.domElement,{width:e,height:t}),this.trigger(m.Types.resize,e,t)},render:function(){return P.group.render.call(this.scene,this.domElement),this}});var Mi=At;var kr={create:function(e,t,i){var r,s,a;if(r=e.createShader(e[i]),e.shaderSource(r,t),e.compileShader(r),s=e.getShaderParameter(r,e.COMPILE_STATUS),!s)throw a=e.getShaderInfoLog(r),e.deleteShader(r),new le("unable to compile shader "+r+": "+a);return r},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},path:{vertex:`
      precision mediump float;
      attribute vec2 a_position;

      uniform mat3 u_matrix;
      uniform vec2 u_resolution;
      uniform vec4 u_rect;

      varying vec2 v_textureCoords;

      void main() {
        vec2 rectCoords = (a_position * (u_rect.zw - u_rect.xy)) + u_rect.xy;
        vec2 projected = (u_matrix * vec3(rectCoords, 1.0)).xy;
        vec2 normal = projected / u_resolution;
        vec2 clipspace = (normal * 2.0) - 1.0;

        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);
        v_textureCoords = a_position;
      }
    `,fragment:`
      precision mediump float;

      uniform sampler2D u_image;
      varying vec2 v_textureCoords;

      void main() {
        vec4 texel = texture2D(u_image, v_textureCoords);
        if (texel.a == 0.0) {
          discard;
        }
        gl_FragColor = texel;
      }
    `},points:{vertex:`
      precision mediump float;
      attribute vec2 a_position;

      uniform float u_size;
      uniform mat3 u_matrix;
      uniform vec2 u_resolution;

      varying vec2 v_textureCoords;

      void main() {
        vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;
        vec2 normal = projected / u_resolution;
        vec2 clipspace = (normal * 2.0) - 1.0;

        gl_PointSize = u_size;
        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);
        v_textureCoords = a_position;
      }
    `,fragment:`
      precision mediump float;

      uniform sampler2D u_image;

      void main() {
        vec4 texel = texture2D(u_image, gl_PointCoord);
        if (texel.a == 0.0) {
          discard;
        }
        gl_FragColor = texel;
      }
    `}},ve=kr;var Tt=Ae.Multiply,wr=[1,0,0,0,1,0,0,0,1],qe=new ye(9),Sr=Ue.Utils,oi=new ye([0,0,1,0,0,1,0,1,1,0,1,1]),L={precision:.9,isHidden:/(undefined|none|transparent)/i,canvas:D.document?D.document.createElement("canvas"):{getContext:function(){}},alignments:{left:"start",middle:"center",right:"end"},matrix:new Ae,group:{removeChild:function(e,t){if(e.children)for(var i=0;i<e.children.length;i++)L.group.removeChild(e.children[i],t);e._renderer.texture&&(t.deleteTexture(e._renderer.texture),delete e._renderer.texture),e._renderer.positionBuffer&&(t.deleteBuffer(e._renderer.positionBuffer),delete e._renderer.positionBuffer)},render:function(e,t){if(!!this._visible){this._update();var i=this.parent,r=i._matrix&&i._matrix.manual||i._flagMatrix,s=this._matrix.manual||this._flagMatrix;(r||s)&&(this._renderer.matrix||(this._renderer.matrix=new ye(9)),this._matrix.toTransformArray(!0,qe),Tt(qe,i._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof w||(this._renderer.scale=new w),this._scale instanceof w?(this._renderer.scale.x=this._scale.x,this._renderer.scale.y=this._scale.y):(this._renderer.scale.x=this._scale,this._renderer.scale.y=this._scale),/renderer/i.test(i._renderer.type)||(this._renderer.scale.x*=i._renderer.scale.x,this._renderer.scale.y*=i._renderer.scale.y),r&&(this._flagMatrix=!0)),this._mask&&(e.clear(e.STENCIL_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,0),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.colorMask(!1,!1,!1,!1),L[this._mask._renderer.type].render.call(this._mask,e,t,this),e.stencilFunc(e.EQUAL,1,255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.colorMask(!0,!0,!0,!0)),this._flagOpacity=i._flagOpacity||this._flagOpacity,this._renderer.opacity=this._opacity*(i&&i._renderer?i._renderer.opacity:1);var a;if(this._flagSubtractions)for(a=0;a<this.subtractions.length;a++)L.group.removeChild(this.subtractions[a],e);for(a=0;a<this.children.length;a++){var n=this.children[a];L[n._renderer.type].render.call(n,e,t)}return this._mask&&e.disable(e.STENCIL_TEST),this.flagReset()}}},path:{updateCanvas:function(e){var t,i,r,s,a,n,o,l,h,_,d,c,u,g,y=e._renderer.vertices,x=this.canvas,p=this.ctx,v=e._renderer.scale,k=e._stroke,T=e._linewidth,S=e._fill,R=e._renderer.opacity||e._opacity,C=e._cap,E=e._join,O=e._miter,F=e._closed,I=e.dashes,j=y.length,X=j-1;x.width=Math.max(Math.ceil(e._renderer.rect.width*v.x),1),x.height=Math.max(Math.ceil(e._renderer.rect.height*v.y),1);var z=e._renderer.rect.centroid,ne=z.x,ke=z.y;p.clearRect(0,0,x.width,x.height),S&&(typeof S=="string"?p.fillStyle=S:(L[S._renderer.type].render.call(S,p,e),p.fillStyle=S._renderer.effect)),k&&(typeof k=="string"?p.strokeStyle=k:(L[k._renderer.type].render.call(k,p,e),p.strokeStyle=k._renderer.effect),T&&(p.lineWidth=T),O&&(p.miterLimit=O),E&&(p.lineJoin=E),!F&&C&&(p.lineCap=C)),typeof R=="number"&&(p.globalAlpha=R),I&&I.length>0&&(p.lineDashOffset=I.offset||0,p.setLineDash(I));var we;p.save(),p.scale(v.x,v.y),p.translate(ne,ke),p.beginPath();for(var Q=0;Q<y.length;Q++){var G=y[Q];switch(c=G.x,u=G.y,G.command){case b.close:p.closePath();break;case b.arc:var Je=G.rx,ie=G.ry,Rt=G.xAxisRotation,Ot=G.largeArcFlag,Ft=G.sweepFlag;t=F?re(Q-1,j):Math.max(Q-1,0),i=y[t];var Ct=i.x,Pt=i.y;Sr.renderSvgArcCommand(p,Ct,Pt,Je,ie,Ot,Ft,Rt,c,u);break;case b.curve:t=F?re(Q-1,j):Math.max(Q-1,0),i=y[t],l=i.controls&&i.controls.right||w.zero,h=G.controls&&G.controls.left||w.zero,i._relative?(n=l.x+i.x,o=l.y+i.y):(n=l.x,o=l.y),G._relative?(s=h.x+G.x,a=h.y+G.y):(s=h.x,a=h.y),p.bezierCurveTo(n,o,s,a,c,u),Q>=X&&F&&(r=we,_=G.controls&&G.controls.right||w.zero,d=r.controls&&r.controls.left||w.zero,G._relative?(n=_.x+G.x,o=_.y+G.y):(n=_.x,o=_.y),r._relative?(s=d.x+r.x,a=d.y+r.y):(s=d.x,a=d.y),c=r.x,u=r.y,p.bezierCurveTo(n,o,s,a,c,u));break;case b.line:p.lineTo(c,u);break;case b.move:we=G,p.moveTo(c,u);break}}F&&p.closePath(),L.isHidden.test(S)||(g=S._renderer&&S._renderer.offset,g&&(p.save(),p.translate(-S._renderer.offset.x,-S._renderer.offset.y),p.scale(S._renderer.scale.x,S._renderer.scale.y)),p.fill(),g&&p.restore()),L.isHidden.test(k)||(g=k._renderer&&k._renderer.offset,g&&(p.save(),p.translate(-k._renderer.offset.x,-k._renderer.offset.y),p.scale(k._renderer.scale.x,k._renderer.scale.y),p.lineWidth=T/k._renderer.scale.x),p.stroke(),g&&p.restore()),p.restore()},getBoundingClientRect:function(e,t,i){var r=1/0,s=-1/0,a=1/0,n=-1/0,o,l;e.forEach(function(h){var _=h.x,d=h.y,c=h.controls,u,g,y,x,p,v;a=Math.min(d,a),r=Math.min(_,r),s=Math.max(_,s),n=Math.max(d,n),!!h.controls&&(p=c.left,v=c.right,!(!p||!v)&&(u=h._relative?p.x+_:p.x,g=h._relative?p.y+d:p.y,y=h._relative?v.x+_:v.x,x=h._relative?v.y+d:v.y,!(!u||!g||!y||!x)&&(a=Math.min(g,x,a),r=Math.min(u,y,r),s=Math.max(u,y,s),n=Math.max(g,x,n))))}),typeof t=="number"&&(a-=t,r-=t,s+=t,n+=t),o=s-r,l=n-a,i.top=a,i.left=r,i.right=s,i.bottom=n,i.width=o,i.height=l,i.centroid||(i.centroid={}),i.centroid.x=-r,i.centroid.y=-a},render:function(e,t,i){if(!this._visible||!this._opacity)return this;this._update();var r=i||this.parent,s=t[this._renderer.type],a=r._matrix.manual||r._flagMatrix,n=this._matrix.manual||this._flagMatrix,o=this._renderer.parent!==r,l=this._flagVertices||this._flagFill||this._fill instanceof H&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof W&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof V&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof H&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof W&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof V&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||r._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((a||n||o)&&(this._renderer.matrix||(this._renderer.matrix=new ye(9)),this._matrix.toTransformArray(!0,qe),Tt(qe,r._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof w||(this._renderer.scale=new w),this._scale instanceof w?(this._renderer.scale.x=this._scale.x*r._renderer.scale.x,this._renderer.scale.y=this._scale.y*r._renderer.scale.y):(this._renderer.scale.x=this._scale*r._renderer.scale.x,this._renderer.scale.y=this._scale*r._renderer.scale.y),o&&(this._renderer.parent=r)),this._mask&&(e.clear(e.STENCIL_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,0),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.colorMask(!1,!1,!1,!1),L[this._mask._renderer.type].render.call(this._mask,e,t,this),e.stencilFunc(e.EQUAL,1,255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.colorMask(!0,!0,!0,!0)),l?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*r._renderer.opacity,L.path.getBoundingClientRect(this._renderer.vertices,this._linewidth,this._renderer.rect),L.updateTexture.call(L,e,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!i||!this._renderer.texture)return this;t.current!==s&&(e.useProgram(s),e.bindBuffer(e.ARRAY_BUFFER,t.buffers.position),e.vertexAttribPointer(s.position,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(s.position),e.bufferData(e.ARRAY_BUFFER,oi,e.STATIC_DRAW),t.resolution.flagged||e.uniform2f(e.getUniformLocation(s,"u_resolution"),t.resolution.width,t.resolution.height),t.current=s),t.resolution.flagged&&e.uniform2f(e.getUniformLocation(s,"u_resolution"),t.resolution.width,t.resolution.height),e.bindTexture(e.TEXTURE_2D,this._renderer.texture);var h=this._renderer.rect;return e.uniformMatrix3fv(s.matrix,!1,this._renderer.matrix),e.uniform4f(s.rect,h.left,h.top,h.right,h.bottom),e.drawArrays(e.TRIANGLES,0,6),this._mask&&e.disable(e.STENCIL_TEST),this.flagReset()}},points:{updateCanvas:function(e){var t,i=this.canvas,r=this.ctx,s=e._stroke,a=e._linewidth,n=e._fill,o=e._renderer.opacity||e._opacity,l=e.dashes,h=e._size,_=h;L.isHidden.test(s)||(_+=a),i.width=Nt(_),i.height=i.width;var d=_/i.width,c=i.width/2,u=i.height/2;r.clearRect(0,0,i.width,i.height),n&&(typeof n=="string"?r.fillStyle=n:(L[n._renderer.type].render.call(n,r,e),r.fillStyle=n._renderer.effect)),s&&(typeof s=="string"?r.strokeStyle=s:(L[s._renderer.type].render.call(s,r,e),r.strokeStyle=s._renderer.effect),a&&(r.lineWidth=a/d)),typeof o=="number"&&(r.globalAlpha=o),l&&l.length>0&&(r.lineDashOffset=l.offset||0,r.setLineDash(l)),r.save(),r.translate(c,u),r.scale(L.precision,L.precision),r.beginPath(),r.arc(0,0,h/d*.5,0,K),r.restore(),closed&&r.closePath(),L.isHidden.test(n)||(t=n._renderer&&n._renderer.offset,t&&(r.save(),r.translate(-n._renderer.offset.x,-n._renderer.offset.y),r.scale(n._renderer.scale.x,n._renderer.scale.y)),r.fill(),t&&r.restore()),L.isHidden.test(s)||(t=s._renderer&&s._renderer.offset,t&&(r.save(),r.translate(-s._renderer.offset.x,-s._renderer.offset.y),r.scale(s._renderer.scale.x,s._renderer.scale.y),r.lineWidth=a/s._renderer.scale.x),r.stroke(),t&&r.restore())},render:function(e,t,i){if(!this._visible||!this._opacity)return this;this._update();var r=i||this.parent,s=t[this._renderer.type],a=this._size,n=this._sizeAttenuation,o=this._stroke,l=this._linewidth,h=r._matrix.manual||r._flagMatrix,_=this._matrix.manual||this._flagMatrix,d=this._renderer.parent!==r,c=this._renderer.vertices,u=this._renderer.collection.length,g=this._flagVertices,y=this._flagFill||this._fill instanceof H&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof W&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof V&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof H&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof W&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof V&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||r._flagOpacity||this._flagVisible||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((h||_||d)&&(this._renderer.matrix||(this._renderer.matrix=new ye(9)),this._matrix.toTransformArray(!0,qe),Tt(qe,r._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof w||(this._renderer.scale=new w),this._scale instanceof w?(this._renderer.scale.x=this._scale.x*r._renderer.scale.x,this._renderer.scale.y=this._scale.y*r._renderer.scale.y):(this._renderer.scale.x=this._scale*r._renderer.scale.x,this._renderer.scale.y=this._scale*r._renderer.scale.y),d&&(this._renderer.parent=r)),g){var x=this._renderer.positionBuffer;x&&e.deleteBuffer(x),this._renderer.positionBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._renderer.positionBuffer),e.vertexAttribPointer(s.position,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(s.position),e.bufferData(e.ARRAY_BUFFER,c,e.STATIC_DRAW)}return y?(this._renderer.opacity=this._opacity*r._renderer.opacity,L.updateTexture.call(L,e,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!i||!this._renderer.texture?this:(L.isHidden.test(o)||(a+=l),a/=L.precision,n&&(a*=Math.max(this._renderer.scale.x,this._renderer.scale.y)),t.current!==s&&(e.useProgram(s),t.resolution.flagged||e.uniform2f(e.getUniformLocation(s,"u_resolution"),t.resolution.width,t.resolution.height),t.current=s),t.resolution.flagged&&e.uniform2f(e.getUniformLocation(s,"u_resolution"),t.resolution.width,t.resolution.height),e.bindTexture(e.TEXTURE_2D,this._renderer.texture),e.uniformMatrix3fv(s.matrix,!1,this._renderer.matrix),e.uniform1f(s.size,a*t.resolution.ratio),e.drawArrays(e.POINTS,0,u),this.flagReset())}},text:{updateCanvas:function(e){var t=this.canvas,i=this.ctx,r=e._renderer.scale,s=e._stroke,a=e._linewidth*r,n=e._fill,o=e._renderer.opacity||e._opacity,l=e.dashes,h=e._decoration;t.width=Math.max(Math.ceil(e._renderer.rect.width*r.x),1),t.height=Math.max(Math.ceil(e._renderer.rect.height*r.y),1);var _=e._renderer.rect.centroid,d=_.x,c=_.y,u,g,y,x,p,v,k,T,S,R,C,E=n._renderer&&n._renderer.offset&&s._renderer&&s._renderer.offset;if(i.clearRect(0,0,t.width,t.height),E||(i.font=[e._style,e._weight,e._size+"px/"+e._leading+"px",e._family].join(" ")),i.textAlign="center",i.textBaseline="middle",n&&(typeof n=="string"?i.fillStyle=n:(L[n._renderer.type].render.call(n,i,e),i.fillStyle=n._renderer.effect)),s&&(typeof s=="string"?i.strokeStyle=s:(L[s._renderer.type].render.call(s,i,e),i.strokeStyle=s._renderer.effect),a&&(i.lineWidth=a)),typeof o=="number"&&(i.globalAlpha=o),l&&l.length>0&&(i.lineDashOffset=l.offset||0,i.setLineDash(l)),i.save(),i.scale(r.x,r.y),i.translate(d,c),L.isHidden.test(n)||(n._renderer&&n._renderer.offset?(v=n._renderer.scale.x,k=n._renderer.scale.y,i.save(),i.translate(-n._renderer.offset.x,-n._renderer.offset.y),i.scale(v,k),u=e._size/n._renderer.scale.y,g=e._leading/n._renderer.scale.y,i.font=[e._style,e._weight,u+"px/",g+"px",e._family].join(" "),y=n._renderer.offset.x/n._renderer.scale.x,x=n._renderer.offset.y/n._renderer.scale.y,i.fillText(e.value,y,x),i.restore()):i.fillText(e.value,0,0)),L.isHidden.test(s)||(s._renderer&&s._renderer.offset?(v=s._renderer.scale.x,k=s._renderer.scale.y,i.save(),i.translate(-s._renderer.offset.x,-s._renderer.offset.y),i.scale(v,k),u=e._size/s._renderer.scale.y,g=e._leading/s._renderer.scale.y,i.font=[e._style,e._weight,u+"px/",g+"px",e._family].join(" "),y=s._renderer.offset.x/s._renderer.scale.x,x=s._renderer.offset.y/s._renderer.scale.y,p=a/s._renderer.scale.x,i.lineWidth=p,i.strokeText(e.value,y,x),i.restore()):i.strokeText(e.value,0,0)),/(underline|strikethrough)/i.test(h)){var O=i.measureText(e.value);switch(h){case"underline":S=O.actualBoundingBoxAscent,C=O.actualBoundingBoxAscent;break;case"strikethrough":S=0,C=0;break}T=-O.width/2,R=O.width/2,i.lineWidth=Math.max(Math.floor(e._size/15),1),i.strokeStyle=i.fillStyle,i.beginPath(),i.moveTo(T,S),i.lineTo(R,C),i.stroke()}i.restore()},getBoundingClientRect:function(e,t){var i=L.ctx;i.font=[e._style,e._weight,e._size+"px/"+e._leading+"px",e._family].join(" "),i.textAlign="center",i.textBaseline=e._baseline;var r=i.measureText(e._value).width*1.25,s=Math.max(e._size,e._leading)*1.25;this._linewidth&&!L.isHidden.test(this._stroke)&&(r+=this._linewidth*2,s+=this._linewidth*2);var a=r/2,n=s/2;switch(L.alignments[e._alignment]||e._alignment){case L.alignments.left:t.left=0,t.right=r;break;case L.alignments.right:t.left=-r,t.right=0;break;default:t.left=-a,t.right=a}switch(e._baseline){case"bottom":t.top=-s,t.bottom=0;break;case"top":t.top=0,t.bottom=s;break;default:t.top=-n,t.bottom=n}t.width=r,t.height=s,t.centroid||(t.centroid={}),t.centroid.x=a,t.centroid.y=n},render:function(e,t,i){if(!this._visible||!this._opacity)return this;this._update();var r=i||this.parent,s=t[this._renderer.type],a=r._matrix.manual||r._flagMatrix,n=this._matrix.manual||this._flagMatrix,o=this._renderer.parent!==r,l=this._flagVertices||this._flagFill||this._fill instanceof H&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof W&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof V&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof H&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof W&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof V&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||r._flagOpacity||this._flagVisible||this._flagScale||this._flagValue||this._flagFamily||this._flagSize||this._flagLeading||this._flagAlignment||this._flagBaseline||this._flagStyle||this._flagWeight||this._flagDecoration||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((a||n||o)&&(this._renderer.matrix||(this._renderer.matrix=new ye(9)),this._matrix.toTransformArray(!0,qe),Tt(qe,r._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof w||(this._renderer.scale=new w),this._scale instanceof w?(this._renderer.scale.x=this._scale.x*r._renderer.scale.x,this._renderer.scale.y=this._scale.y*r._renderer.scale.y):(this._renderer.scale.x=this._scale*r._renderer.scale.x,this._renderer.scale.y=this._scale*r._renderer.scale.y),o&&(this._renderer.parent=r)),this._mask&&(e.clear(e.STENCIL_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,0),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.colorMask(!1,!1,!1,!1),L[this._mask._renderer.type].render.call(this._mask,e,t,this),e.stencilFunc(e.EQUAL,1,255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.colorMask(!0,!0,!0,!0)),l?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*r._renderer.opacity,L.text.getBoundingClientRect(this,this._renderer.rect),L.updateTexture.call(L,e,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!i||!this._renderer.texture)return this;t.current!==s&&(e.useProgram(s),e.bindBuffer(e.ARRAY_BUFFER,t.buffers.position),e.vertexAttribPointer(s.position,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(s.position),e.bufferData(e.ARRAY_BUFFER,oi,e.STATIC_DRAW),t.resolution.flagged||e.uniform2f(e.getUniformLocation(s,"u_resolution"),t.resolution.width,t.resolution.height),t.current=s),t.resolution.flagged&&e.uniform2f(e.getUniformLocation(s,"u_resolution"),t.resolution.width,t.resolution.height),e.bindTexture(e.TEXTURE_2D,this._renderer.texture);var h=this._renderer.rect;return e.uniformMatrix3fv(s.matrix,!1,this._renderer.matrix),e.uniform4f(s.rect,h.left,h.top,h.right,h.bottom),e.drawArrays(e.TRIANGLES,0,6),this._mask&&e.disable(e.STENCIL_TEST),this.flagReset()}},"linear-gradient":{render:function(e,t){if(!(!e.canvas.getContext("2d")||!t)){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){var i,r=this.left._x,s=this.left._y,a=this.right._x,n=this.right._y;/objectBoundingBox/i.test(this._units)&&(i=t.getBoundingClientRect(!0),r=(r-.5)*i.width,s=(s-.5)*i.height,a=(a-.5)*i.width,n=(n-.5)*i.height),this._renderer.effect=e.createLinearGradient(r,s,a,n);for(var o=0;o<this.stops.length;o++){var l=this.stops[o];this._renderer.effect.addColorStop(l._offset,l._color)}}return this.flagReset()}}},"radial-gradient":{render:function(e,t){if(!(!e.canvas.getContext("2d")||!t)){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){var i,r=this.center._x,s=this.center._y,a=this.focal._x,n=this.focal._y,o=this._radius;/objectBoundingBox/i.test(this._units)&&(i=t.getBoundingClientRect(!0),r=r*i.width*.5,s=s*i.height*.5,a=a*i.width*.5,n=n*i.height*.5,o*=Math.min(i.width,i.height)*.5),this._renderer.effect=e.createRadialGradient(r,s,0,a,n,o);for(var l=0;l<this.stops.length;l++){var h=this.stops[l];this._renderer.effect.addColorStop(h._offset,h._color)}}return this.flagReset()}}},texture:{render:function(e,t){if(!!e.canvas.getContext("2d")){this._update();var i=this.image;if((this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)this._renderer.effect=e.createPattern(i,this._repeat);else if(!this._renderer.effect)return this.flagReset();return(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof w||(this._renderer.offset=new w),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,i&&(this._renderer.offset.x+=i.width/2,this._renderer.offset.y+=i.height/2,this._scale instanceof w?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof w||(this._renderer.scale=new w),this._scale instanceof w?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}}},updateTexture:function(e,t){if(this[t._renderer.type].updateCanvas.call(L,t),this.canvas.width<=0||this.canvas.height<=0){t._renderer.texture&&e.deleteTexture(t._renderer.texture),delete t._renderer.texture;return}t._renderer.texture||(t._renderer.texture=e.createTexture()),e.bindTexture(e.TEXTURE_2D,t._renderer.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.canvas)},program:{create:function(e,t){var i,r,s;if(i=e.createProgram(),f.each(t,function(a){e.attachShader(i,a)}),e.linkProgram(i),r=e.getProgramParameter(i,e.LINK_STATUS),!r)throw s=e.getProgramInfoLog(i),e.deleteProgram(i),new le("unable to link program: "+s);return i}},TextureRegistry:new je};L.ctx=L.canvas.getContext("2d");function Mt(e){var t,i,r,s;if(this.domElement=e.domElement||document.createElement("canvas"),typeof e.offscreenElement!="undefined"&&(L.canvas=e.offscreenElement,L.ctx=L.canvas.getContext("2d")),this.scene=new te,this.scene.parent=this,this._renderer={type:"renderer",matrix:new ye(wr),scale:1,opacity:1},this._flagMatrix=!0,e=f.defaults(e||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1}),this.overdraw=e.overdraw,t=this.ctx=this.domElement.getContext("webgl",e)||this.domElement.getContext("experimental-webgl",e),!this.ctx)throw new le("unable to create a webgl context. Try using another renderer.");r=ve.create(t,ve.path.vertex,ve.types.vertex),s=ve.create(t,ve.path.fragment,ve.types.fragment),this.programs={current:null,buffers:{position:t.createBuffer()},resolution:{width:0,height:0,ratio:1,flagged:!1}},i=this.programs.path=L.program.create(t,[r,s]),this.programs.text=this.programs.path,i.position=t.getAttribLocation(i,"a_position"),i.matrix=t.getUniformLocation(i,"u_matrix"),i.rect=t.getUniformLocation(i,"u_rect");var a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),t.vertexAttribPointer(i.position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(i.position),t.bufferData(t.ARRAY_BUFFER,oi,t.STATIC_DRAW),r=ve.create(t,ve.points.vertex,ve.types.vertex),s=ve.create(t,ve.points.fragment,ve.types.fragment),i=this.programs.points=L.program.create(t,[r,s]),i.position=t.getAttribLocation(i,"a_position"),i.matrix=t.getUniformLocation(i,"u_matrix"),i.size=t.getUniformLocation(i,"u_size"),t.enable(t.BLEND),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)}f.extend(Mt,{Utils:L});f.extend(Mt.prototype,m,{constructor:Mt,setSize:function(e,t,i){var r,s,a=this.ctx;return this.width=e,this.height=t,this.ratio=typeof i=="undefined"?Ze(a):i,this.domElement.width=e*this.ratio,this.domElement.height=t*this.ratio,f.isObject(this.domElement.style)&&f.extend(this.domElement.style,{width:e+"px",height:t+"px"}),this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio,this._flagMatrix=!0,r=e*this.ratio,s=t*this.ratio,a.viewport(0,0,r,s),this.programs.resolution.width=r,this.programs.resolution.height=s,this.programs.resolution.ratio=this.ratio,this.programs.resolution.flagged=!0,this.trigger(m.Types.resize,e,t,i)},render:function(){var e=this.ctx;return this.overdraw||e.clear(e.COLOR_BUFFER_BIT),L.group.render.call(this.scene,e,this.programs),this._flagMatrix=!1,this.programs.resolution.flagged=!0,this}});var Ri=Mt;function be(e){var t=f.defaults(e||{},{fullscreen:!1,fitted:!1,width:640,height:480,type:be.Types.svg,autostart:!1});if(f.each(t,function(r,s){/fullscreen/i.test(s)||/autostart/i.test(s)||(this[s]=r)},this),f.isElement(t.domElement)){var i=t.domElement.tagName.toLowerCase();/^(CanvasRenderer-canvas|WebGLRenderer-canvas|SVGRenderer-svg)$/.test(this.type+"-"+i)||(this.type=be.Types[i])}this.renderer=new be[this.type](this),this.setPlaying(t.autostart),this.frameCount=0,t.fullscreen?(this.fit=Ar.bind(this),this.fit.domElement=window,this.fit.attached=!0,f.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),f.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),Fe.bind(this.fit.domElement,"resize",this.fit),this.fit()):t.fitted?(this.fit=Tr.bind(this),f.extend(this.renderer.domElement.style,{display:"block"})):f.isElement(t.domElement)||(this.renderer.setSize(t.width,t.height,this.ratio),this.width=t.width,this.height=t.height),this.renderer.bind(m.Types.resize,Mr.bind(this)),this.scene=this.renderer.scene,be.Instances.push(this),t.autostart&&ht.init()}f.extend(be,ee);f.extend(be.prototype,m,{constructor:be,type:"",renderer:null,scene:null,width:0,height:0,frameCount:0,timeDelta:0,playing:!1,appendTo:function(e){return e.appendChild(this.renderer.domElement),this.fit&&(this.fit.domElement!==window&&(this.fit.domElement=e,this.fit.attached=!1),this.update()),this},play:function(){return this.playing=!0,ht.init(),this.trigger(m.Types.play)},pause:function(){return this.playing=!1,this.trigger(m.Types.pause)},setPlaying:function(e){this.playing=e},release:function(e){var t,i,r;if(!f.isObject(e))return this.release(this.scene);if(typeof e.unbind=="function"&&e.unbind(),e.vertices)for(typeof e.vertices.unbind=="function"&&e.vertices.unbind(),t=0;t<e.vertices.length;t++)i=e.vertices[t],typeof i.unbind=="function"&&i.unbind(),i.controls&&(i.controls.left&&typeof i.controls.left.unbind=="function"&&i.controls.left.unbind(),i.controls.right&&typeof i.controls.right.unbind=="function"&&i.controls.right.unbind());if(e.children){for(t=0;t<e.children.length;t++)r=e.children[t],this.release(r);typeof e.children.unbind=="function"&&e.children.unbind()}return e},update:function(){var e=!!this._lastFrame,t=f.performance.now();e&&(this.timeDelta=parseFloat((t-this._lastFrame).toFixed(3))),this._lastFrame=t,this.fit&&this.fit.domElement&&!this.fit.attached&&(Fe.bind(this.fit.domElement,"resize",this.fit),this.fit.attached=!0,this.fit());var i=this.width,r=this.height,s=this.renderer;return(i!==s.width||r!==s.height)&&s.setSize(i,r,this.ratio),this.trigger(m.Types.update,this.frameCount,this.timeDelta),this.render()},render:function(){return this.renderer.render(),this.trigger(m.Types.render,this.frameCount++)},add:function(e){var t=e;return t instanceof Array||(t=Array.prototype.slice.call(arguments)),this.scene.add(t),this},remove:function(e){var t=e;return t instanceof Array||(t=Array.prototype.slice.call(arguments)),this.scene.remove(t),this},clear:function(){return this.scene.remove(this.scene.children),this},makeLine:function(e,t,i,r){var s=new at(e,t,i,r);return this.scene.add(s),s},makeArrow:function(e,t,i,r,s){var a=typeof s=="number"?s:10,n=Math.atan2(r-t,i-e),o=[new M(e,t,void 0,void 0,void 0,void 0,b.move),new M(i,r,void 0,void 0,void 0,void 0,b.line),new M(i-a*Math.cos(n-Math.PI/4),r-a*Math.sin(n-Math.PI/4),void 0,void 0,void 0,void 0,b.line),new M(i,r,void 0,void 0,void 0,void 0,b.move),new M(i-a*Math.cos(n+Math.PI/4),r-a*Math.sin(n+Math.PI/4),void 0,void 0,void 0,void 0,b.line)],l=new A(o,!1,!1,!0);return l.noFill(),l.cap="round",l.join="round",this.scene.add(l),l},makeRectangle:function(e,t,i,r){var s=new se(e,t,i,r);return this.scene.add(s),s},makeRoundedRectangle:function(e,t,i,r,s){var a=new ot(e,t,i,r,s);return this.scene.add(a),a},makeCircle:function(e,t,i,r){var s=new st(e,t,i,r);return this.scene.add(s),s},makeEllipse:function(e,t,i,r,s){var a=new nt(e,t,i,r,s);return this.scene.add(a),a},makeStar:function(e,t,i,r,s){var a=new ai(e,t,i,r,s);return this.scene.add(a),a},makeCurve:function(e){var t=arguments.length,i=e;if(!Array.isArray(e)){i=[];for(var r=0;r<t;r+=2){var s=arguments[r];if(typeof s!="number")break;var a=arguments[r+1];i.push(new M(s,a))}}var n=arguments[t-1],o=new A(i,!(typeof n=="boolean"?n:void 0),!0),l=o.getBoundingClientRect();return o.center().translation.set(l.left+l.width/2,l.top+l.height/2),this.scene.add(o),o},makePolygon:function(e,t,i,r){var s=new ni(e,t,i,r);return this.scene.add(s),s},makeArcSegment:function(e,t,i,r,s,a,n){var o=new ri(e,t,i,r,s,a,n);return this.scene.add(o),o},makePoints:function(e){var t=arguments.length,i=e;if(!Array.isArray(e)){i=[];for(var r=0;r<t;r+=2){var s=arguments[r];if(typeof s!="number")break;var a=arguments[r+1];i.push(new w(s,a))}}var n=new si(i);return this.scene.add(n),n},makePath:function(e){var t=arguments.length,i=e;if(!Array.isArray(e)){i=[];for(var r=0;r<t;r+=2){var s=arguments[r];if(typeof s!="number")break;var a=arguments[r+1];i.push(new M(s,a))}}var n=arguments[t-1],o=new A(i,!(typeof n=="boolean"?n:void 0)),l=o.getBoundingClientRect();return typeof l.top=="number"&&typeof l.left=="number"&&typeof l.right=="number"&&typeof l.bottom=="number"&&o.center().translation.set(l.left+l.width/2,l.top+l.height/2),this.scene.add(o),o},makeText:function(e,t,i,r){var s=new Me(e,t,i,r);return this.add(s),s},makeLinearGradient:function(e,t,i,r){var s=Array.prototype.slice.call(arguments,4),a=new H(e,t,i,r,s);return this.add(a),a},makeRadialGradient:function(e,t,i){var r=Array.prototype.slice.call(arguments,3),s=new W(e,t,i,r);return this.add(s),s},makeSprite:function(e,t,i,r,s,a,n){var o=new rt(e,t,i,r,s,a);return n&&o.play(),this.add(o),o},makeImageSequence:function(e,t,i,r,s){var a=new ii(e,t,i,r);return s&&a.play(),this.add(a),a},makeTexture:function(e,t){var i=new V(e,t);return i},makeGroup:function(e){var t=e;t instanceof Array||(t=Array.prototype.slice.call(arguments));var i=new te;return this.scene.add(i),i.add(t),i},interpret:function(e,t,i){var r=e.tagName.toLowerCase();if(i=typeof i!="undefined"?i:!0,!(r in St))return null;var s=St[r].call(this,e);return i?this.add(t&&s instanceof te?s.children:s):s.parent&&s.remove(),s},load:function(e,t){var i=new te,r,s,a,n=function(o){for(Fe.temp.innerHTML=o,s=0;s<Fe.temp.children.length;s++)r=Fe.temp.children[s],a=this.interpret(r,!1,!1),a!==null&&i.add(a);if(typeof t=="function"){var l=Fe.temp.children.length<=1?Fe.temp.children[0]:Fe.temp.children;t(i,l)}}.bind(this);return/.*\.svg/ig.test(e)?(ti(e,n),i):(n(e),i)}});function Ar(){var e=document.body.getBoundingClientRect(),t=this.width=e.width,i=this.height=e.height;this.renderer.setSize(t,i,this.ratio)}function Tr(){var e=this.renderer.domElement.parentElement;if(!e){console.warn("Two.js: Attempting to fit to parent, but no parent found.");return}var t=e.getBoundingClientRect(),i=this.width=t.width,r=this.height=t.height;this.renderer.setSize(i,r,this.ratio)}function Mr(e,t){this.width=e,this.height=t,this.trigger(m.Types.resize,e,t)}var ht=Fe.getRequestAnimationFrame();function Oi(){for(var e=0;e<be.Instances.length;e++){var t=be.Instances[e];t.playing&&t.update()}be.nextFrameID=ht(Oi)}ht.init=function(){Oi(),ht.init=function(){}};f.extend(be,{Anchor:M,Collection:fe,Events:m,Group:te,Matrix:Ae,Path:A,Registry:je,Shape:Y,Text:Me,Vector:w,Gradient:B,ImageSequence:ii,LinearGradient:H,RadialGradient:W,Sprite:rt,Stop:Te,Texture:V,ArcSegment:ri,Circle:st,Ellipse:nt,Line:at,Points:si,Polygon:ni,Rectangle:se,RoundedRectangle:ot,Star:ai,CanvasRenderer:Ue,SVGRenderer:Mi,WebGLRenderer:Ri,Commands:b,Utils:f.extend({Error:le,getRatio:Ze,defineGetterSetter:N,read:St,xhr:ti},f,ge,Dt,Vt)});var Rr=be;return Ni(Or);})().default;
